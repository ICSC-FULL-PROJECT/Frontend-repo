<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICSC 2026 - Partner Registration</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,400italic,700italic" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css">
    <link rel="icon" href="title.png" type="image/x-icon">
    <style>
        :root {
            --primary-color: #28a745;
            --primary-dark: #218838;
            --secondary-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --light-gray: #f8f9fa;
            --border-color: #e9ecef;
            --text-dark: #2c3e50;
            --text-light: #6c757d;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #ffffff;
            line-height: 1.6;
            color: var(--text-dark);
            margin: 0;
            padding: 0;
        }
        
        .site-background {
            background-color: #ffffff !important;
        }
        
        .navbar {
            background: white;
            border: none;
            margin-bottom: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 0.5rem 0;
        }
        
        .jumbotron {
            background-color: #ffffff;
            margin-bottom: 0;
            padding: 30px 0;
        }
        
        .logo img {
            max-height: 80px;
            width: auto;
        }
        
        .form-section {
            background: white;
            border-radius: 8px;
            padding: 25px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            width: 100%;
        }
        
        .has-star::after {
            content: " *";
            color: var(--danger-color);
        }
        
        .btn-standard {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            padding: 14px 25px;
            font-weight: bold;
            font-size: 1rem;
            border-radius: 8px;
            width: 100%;
            margin: 5px 0;
        }
        
        .btn-standard:hover {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            color: white;
        }

        .btn-success {
            background-color: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
            border-color: #218838;
            color: white;
        }
        
        .btn-outline-standard {
            background-color: transparent;
            border-color: var(--primary-color);
            color: var(--primary-color);
            padding: 14px 25px;
            font-weight: bold;
            border-radius: 8px;
            width: 100%;
            margin: 5px 0;
        }
        
        .btn-outline-standard:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .social-media-links a {
            color: var(--primary-color) !important;
        }
        
        .footer-container {
            background-color: var(--light-gray);
            padding: 30px 0;
            margin-top: 40px;
        }
        
        .help-block-error {
            color: var(--danger-color);
            font-size: 0.8em;
            display: none;
            margin-top: 5px;
        }
        
        .hint-block {
            font-size: 0.8em;
            color: var(--text-light);
            margin-top: 5px;
        }
        
        .form-group {
            margin-bottom: 1.2rem;
            position: relative;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            border: 1px solid #f5c6cb;
            display: none;
            font-size: 0.9rem;
        }
        
        input.error, select.error, textarea.error {
            border-color: var(--danger-color);
        }
        
        .confirmation-details {
            background: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .confirmation-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .confirmation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .confirmation-label {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .confirmation-value {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
            text-align: center;
            margin: 20px 0;
        }
        
        .package-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .package-card {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .package-card:hover {
            border-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.1);
        }
        
        .package-card.selected {
            border-color: var(--primary-color);
            background: #f8fff9;
        }
        
        .package-card h4 {
            margin-bottom: 12px;
            color: var(--text-dark);
            text-align: center;
            font-size: 1.2rem;
        }
        
        .package-card .price {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--success-color);
            text-align: center;
            margin: 12px 0;
        }
        
        .package-card ul {
            padding-left: 18px;
            margin-bottom: 12px;
        }
        
        .package-card li {
            margin-bottom: 6px;
            color: var(--text-light);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .package-card .limited {
            color: var(--danger-color);
            font-weight: bold;
            text-align: center;
            margin-top: 8px;
            font-size: 0.8rem;
        }
        
        .payment-section {
            background: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .payment-option {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            background: white;
        }
        
        .payment-option.selected {
            border-color: var(--primary-color);
            background: #f8fff9;
        }
        
        .payment-option input {
            margin-right: 10px;
        }
        
        .payment-option label {
            margin-bottom: 0;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .payment-form {
            margin-top: 15px;
            display: none;
        }
        
        .iti {
            width: 100%;
        }
        
        .phone-input-container {
            position: relative;
        }
        
        .phone-input-container .form-control {
            padding-left: 52px;
        }
        
        .pdf-viewer {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 18px;
            margin: 18px 0;
            background: var(--light-gray);
        }
        
        .pdf-viewer h5 {
            margin-bottom: 12px;
            color: var(--text-dark);
            font-size: 1.1rem;
        }
        
        .pdf-placeholder {
            background: white;
            border-radius: 6px;
            padding: 30px 20px;
            text-align: center;
            border: 2px dashed var(--border-color);
        }
        
        .pdf-placeholder i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 12px;
        }

        .sponsor-package-info {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 18px;
            margin: 18px 0;
            border-radius: 4px;
        }

        .sponsor-package-info h5 {
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            top: 38px;
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            z-index: 10;
        }

        .password-toggle:focus {
            outline: none;
        }

        .button-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .container {
            padding-left: 15px;
            padding-right: 15px;
            max-width: 100%;
        }
        
        .checkbox-group {
            background: var(--light-gray);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .checkbox-item {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .checkbox-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .checkbox-label {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
        }
        
        .checkbox-label input {
            margin-right: 10px;
            margin-top: 4px;
        }
        
        .checkbox-text {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .checkbox-note {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 5px;
            font-style: italic;
        }
        
        .newsletter-option {
            background: var(--light-gray);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    /* Notification styles for mock mode */
    .mock-notice {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 8px;
        padding: 12px 15px;
        margin-bottom: 20px;
        text-align: center;
        color: #856404;
    }
    
    .mock-notice i {
        margin-right: 8px;
    }
    
    .package-description {
        color: #666;
        font-size: 0.9rem;
        margin-bottom: 10px;
        line-height: 1.4;
    }
    
    /* Improved disabled package styling */
    .package-card.disabled {
        opacity: 0.6;
        cursor: not-allowed;
        position: relative;
    }
    
    .package-card.disabled::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 8px;
    }
    
    .limited {
        margin-top: 8px;
        font-size: 0.85rem;
        text-align: center;
        font-weight: 500;
        padding: 4px 8px;
        border-radius: 4px;
        background: #f8f9fa;
    }
    
    .payment-amount {
        background: #e8f5e9;
        padding: 10px 15px;
        border-radius: 6px;
        margin-bottom: 15px;
        border-left: 3px solid #28a745;
    }


        /* Fix for button layout issue */
        .content-section .container {
            position: relative;
            z-index: 1;
        }

        .form-section {
            position: relative;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1rem;
            }
            
            .jumbotron h1 {
                font-size: 1.5rem;
            }
            
            .jumbotron .lead {
                font-size: 0.9rem;
            }
            
            .form-section {
                padding: 20px 15px;
            }
            
            .package-card {
                padding: 15px;
            }
            
            .confirmation-details, .payment-section {
                padding: 15px;
            }
            
            .pdf-viewer {
                padding: 15px;
            }
            
            .btn-standard, .btn-outline-standard {
                padding: 12px 20px;
                font-size: 0.95rem;
            }
        }

        @media (max-width: 576px) {
            .package-card h4 {
                font-size: 1.1rem;
            }
            
            .success-message {
                padding: 15px;
            }
            
            .container {
                padding-left: 10px;
                padding-right: 10px;
            }
        }

        @media (min-width: 768px) {
            .package-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .button-container {
                flex-direction: row;
                justify-content: space-between;
            }
            
            .btn-standard, .btn-outline-standard {
                width: auto;
                margin: 0;
            }
        }

        @media (min-width: 992px) {
            .package-cards {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (hover: none) {
            .package-card:hover {
                transform: none;
                border-color: var(--border-color);
            }
            
            .package-card.selected {
                border-color: var(--primary-color);
                transform: scale(1.02);
            }
        }

        button:focus,
        input:focus,
        select:focus,
        textarea:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        .btn-loading {
            position: relative;
            color: transparent;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-right-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="standard-page">
    <!-- Navigation -->
    <div id="nav-wrap">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container">
                <div class="d-flex align-items-center">
                    <div class="logo me-3">
                        <img src="icsc-logos.png" alt="ICSC 2026" class="img-fluid">
                    </div>
                    <span class="navbar-brand mb-0 h1"></span>
                </div>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="login.html">SIGN IN</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="agenda.html">AGENDA</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>

    <!-- Header -->
    <div id="header-wrap" class="jumbotron site-background">
        <div class="container">
            <div class="text-center">
                <h1>INTERNATIONAL CIVIL SERVICE CONFERENCE (ICSC) 2026</h1>
                <p class="lead">Building Global Civil Service Excellence</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content-section">
        <div class="container">
            <div class="text-center mb-4">
                <p class="lead"><strong>To return to the International Civil Service Conference website please click <a href="Index.html" target="_blank">here</a>.</strong></p>
            </div>

            <!-- Single Comprehensive Form Section -->
            <div id="main-form-section" class="form-section">
                <h2 class="text-center mb-4">Partner Registration</h2>
                
                <form id="main-form">
                    <!-- Email and Password Section -->
                    <div class="form-group">
                        <label class="has-star" for="email">Email Address</label>
                        <input type="email" id="email" name="email" class="form-control" required>
                        <div class="help-block-error" id="email-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="password">Choose a Password</label>
                        <div class="position-relative">
                            <input type="password" id="password" name="password" class="form-control" required>
                            <button type="button" class="password-toggle" id="togglePassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="help-block-error" id="password-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="confirmPassword">Repeat Your Password</label>
                        <div class="position-relative">
                            <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
                            <button type="button" class="password-toggle" id="toggleConfirmPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="help-block-error" id="confirmPassword-error"></div>
                    </div>
                    
                    <!-- Company Information -->
                    <div class="form-group">
                        <label class="has-star" for="prefix">Prefix</label>
                        <select id="prefix" name="prefix" class="form-control" required>
                            <option value="">Please choose...</option>
                            <option value="Mr">Mr</option>
                            <option value="Mrs">Mrs</option>
                            <option value="Miss">Miss</option>
                            <option value="Ms">Ms</option>
                            <option value="Dr">Dr</option>
                            <option value="Prof">Prof</option>
                        </select>
                        <div class="help-block-error" id="prefix-error"></div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="has-star" for="firstName">First name</label>
                            <input type="text" id="firstName" name="firstName" class="form-control" required>
                            <div class="help-block-error" id="firstName-error"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="has-star" for="lastName">Last name</label>
                            <input type="text" id="lastName" name="lastName" class="form-control" required>
                            <div class="help-block-error" id="lastName-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="country">Country</label>
                        <select id="country" name="country" class="form-control" required>
                            <option value="" disabled>Select your country</option>
                        </select>
                        <div class="help-block-error" id="country-error"></div>
                    </div>
                    <div class="form-group">
                        <label class="has-star" for="jobTitle">Job title</label>
                        <input type="text" id="jobTitle" name="jobTitle" class="form-control" required>
                        <div class="help-block-error" id="jobTitle-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="organisation">Organisation/MDA/Company</label>
                        <input type="text" id="organisation" name="organisation" class="form-control" required>
                        <div class="help-block-error" id="organisation-error"></div>
                    </div>

                    <div class="form-group">
    <label for="companyLogo">Company Logo (Optional)</label>
    <div class="d-flex align-items-center gap-3">
        <input type="file" id="companyLogo" name="companyLogo" class="form-control" accept="image/*" style="flex-grow: 1;">
        <div id="logoPreviewContainer" style="display: none; flex-shrink: 0;">
            <img id="logoPreview" src="#" alt="Logo Preview" style="height: 45px; width: 45px; object-fit: contain; border: 1px solid var(--border-color); border-radius: 4px; background: #fff; padding: 2px;">
        </div>
    </div>
    <div class="help-block-error" id="companyLogo-error"></div>
    <div class="hint-block">Recommended: PNG or JPG (Square format works best)</div>
</div>
                    
                    <div class="form-group">
                        <label class="has-star" for="workPhone">Work phone</label>
                        <div class="phone-input-container">
                            <input type="tel" id="workPhone" name="workPhone" class="form-control" placeholder="0802 123 4567" required>
                        </div>
                        <div class="help-block-error" id="workPhone-error"></div>
                    </div>
                    
                    <!-- Data Sharing Agreement -->
                    <div class="checkbox-group">
                        <h5>I agree to my information being shared with third party partners and exhibitors of the International Civil Service Conference</h5>
                        
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="radio" name="dataSharing" value="yes" required>
                                <div class="checkbox-text">
                                    <strong>Yes, I agree to the data I have submitted being shared with the third party knowledge partners and exhibitors of International Civil Service Conference</strong>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="radio" name="dataSharing" value="no" required>
                                <div class="checkbox-text">
                                    <strong>No, I do not agree to share my data with relevant third party organisations</strong>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-note">
                            * Please note that in this instance 'data' refers to your name, job title, organisation, email address and contact number submitted as part of this registration form.
                        </div>
                        
                        <div class="checkbox-note">
                            * All third party knowledge partners and exhibitors of the inaugural International Civil Service Conference can be found <a href="#" target="_blank">here</a>
                        </div>
                    </div>
                    
                    <!-- Terms and Conditions -->
                    <div class="checkbox-group">
                        <h5>Terms and conditions</h5>
                        
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="checkbox" id="terms" name="terms" required>
                                <div class="checkbox-text">
                                    <strong>I have read and agree with the Terms and Conditions, and wish to register for International Civil Service Conference</strong>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-note">
                            * Terms and conditions for International Civil Service Conference can be found <a href="#" target="_blank">here</a>
                        </div>
                    </div>
                    
                    <!-- Newsletter Subscription -->
                    <div class="newsletter-option">
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="checkbox" id="newsletter" name="newsletter">
                                <div class="checkbox-text">
                                    <strong>Subscribe to our newsletter</strong><br>
                                    <span class="checkbox-note">Yes please, sign me up!</span>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-note">
                            *Tick this box if you would like to have the weekly Global Government Forum newsletters sent directly to your inbox. It's free and if you change your mind you can unsubscribe at any time.
                        </div>
                    </div>
                </form>
                
                <div class="button-container">
                    <a href="register.html" class="btn btn-outline-standard">
                        <i class="fas fa-arrow-circle-left me-2"></i> Back to Registration Types
                    </a>
                    <button type="button" class="btn btn-standard" id="continue-to-package-btn">
                        Continue to Package Selection <i class="fas fa-arrow-circle-right ms-2"></i>
                    </button>
                </div>
            </div>

            <!-- Step 2: Package Selection Section -->
            <div id="package-section" class="form-section" style="display: none;">
                <h2 class="text-center mb-4">Select Your Partnership Package</h2>
                
                <div class="mock-notice" id="mock-notice" style="display: none;">
                    <i class="fas fa-code"></i>
                    <strong>Development Mode:</strong> Using mock data. Packages will sync with admin system when backend is ready.
                </div>
                
                <p class="text-center mb-4">Choose the partnership package that best fits your organization's goals</p>
                
                <div class="package-cards">
                    <!-- Packages will be loaded dynamically from the admin system -->
                </div>
                
                <div class="button-container">
                    <button type="button" class="btn btn-outline-standard" id="back-to-main-form-btn">
                        <i class="fas fa-arrow-circle-left me-2"></i> Back
                    </button>
                    <button type="button" class="btn btn-standard" id="continue-to-payment-btn" disabled>
                        Continue to Payment <i class="fas fa-arrow-circle-right ms-2"></i>
                    </button>
                </div>
            </div>

            <!-- Step 3: Payment Section -->
            <div id="payment-section" class="form-section" style="display: none;">
                <h2 class="text-center mb-4">Payment Information</h2>
                
                <div class="payment-section">
                    <div class="form-group">
                        <label class="has-star">Select Payment Method</label>
                        <!-- <div class="payment-option">
                            <input type="radio" id="bank-transfer" name="payment-method" value="bank-transfer">
                            <label for="bank-transfer">Bank Transfer</label>
                        </div> -->
                        <div class="payment-option">
                            <input type="radio" id="flutterwave" name="payment-method" value="flutterwave">
                            <label for="flutterwave">Flutterwave</label>
                        </div>
                    </div>
                    
                    <div class="payment-form" id="bank-transfer-form">
                        <h5>Bank Transfer Details</h5>
                        <!-- Add payment amount dynamically here -->
                        <div id="bank-transfer-amount"></div>
                        <p><strong>Bank Name:</strong> First Bank Nigeria</p>
                        <p><strong>Account Name:</strong> ICSC 2026 Conference</p>
                        <p><strong>Account Number:</strong> 1234567890</p>
                        <p><strong>Sort Code:</strong> 123456</p>
                        <p>Please include your registration ID as the payment reference.</p>
                        
                        <!-- Payment Receipt Upload - Only for Bank Transfer -->
                        <div class="form-group mt-4">
                            <label class="has-star" for="paymentReceipt">Upload Payment Receipt</label>
                            <input type="file" id="paymentReceipt" name="paymentReceipt" class="form-control" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx">
                            <div class="help-block-error" id="paymentReceipt-error"></div>
                            <div class="hint-block">Accepted formats: PDF, JPG, PNG, DOC (Max size: 5MB)</div>
                        </div>
                    </div>
                    
                    <div class="payment-form" id="flutterwave-form">
                        <h5>Flutterwave Payment</h5>
                        <div id="flutterwave-amount"></div>
                        <p>You will be redirected to Flutterwave's secure payment gateway to complete your transaction.</p>
                        <p>Accepted payment methods:</p>
                        <ul>
                            <li>Visa/Mastercard</li>
                            <li>Bank Transfer</li>
                            <li>USSD</li>
                            <li>Mobile Money</li>
                        </ul>
                        <button type="button" class="btn btn-standard" id="pay-with-flutterwave">
                            <i class="fas fa-credit-card me-2"></i>Pay with Flutterwave
                        </button>
                    </div>
                </div>
                
                <div class="button-container">
                    <button type="button" class="btn btn-outline-standard" id="back-to-package-btn">
                        <i class="fas fa-arrow-circle-left me-2"></i> Back
                    </button>
                    <button type="button" class="btn btn-standard" id="complete-registration-btn" disabled>
                        Complete Registration
                    </button>
                </div>
            </div>

            <!-- Step 4: Confirmation Section -->
            <div id="confirmation-section" class="form-section" style="display: none;">
                <h2 class="text-center mb-4">Registration Confirmation</h2>
                
                <div class="success-message">
                    <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                    <h3>Registration Successful!</h3>
                    <p class="mb-0">Thank you for registering as a Partner for the International Civil Service Conference 2026.</p>
                </div>
                
                <div class="confirmation-details">
                    <h4 class="mb-3">Registration Details</h4>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Transaction ID</div>
                        <div class="confirmation-value" id="confirmation-id">ICSC2026-001234</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Registrant Type</div>
                        <div class="confirmation-value" id="confirmation-type">Partner</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Name</div>
                        <div class="confirmation-value" id="confirmation-name">John Doe</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Email</div>
                        <div class="confirmation-value" id="confirmation-email">john.doe@example.com</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Selected Package</div>
                        <div class="confirmation-value" id="confirmation-package">Basic Partner Package</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Payment Status</div>
                        <div class="confirmation-value" id="confirmation-payment">Pending</div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <p>A confirmation email has been sent to <strong id="confirmation-email-text">john.doe@example.com</strong> with all the details.</p>
                    <div class="button-container">
                        <button type="button" class="btn btn-standard" id="go-to-dashboard-btn">
                            Go to Dashboard
                        </button>
                        <a href="Index.html" class="btn btn-outline-standard">Return to Conference Website</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer-container">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>INTERNATIONAL CIVIL SERVICE CONFERENCE (ICSC) 2026</h5>
                    <p>Building Global Civil Service Excellence</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5>Contact Us</h5>
                    <p>Email: info@icsc2026.org</p>
                    <p>Phone: +1 (555) 123-4567</p>
                    <div class="social-media-links mt-3">
                        <a href="#" class="me-3"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="me-3"><i class="fab fa-linkedin fa-lg"></i></a>
                        <a href="#" class="me-3"><i class="fab fa-facebook fa-lg"></i></a>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <p class="mb-0">&copy; 2026 International Civil Service Conference. All rights reserved.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <script src="js/apiClient.js"></script>
    <script src="js/auth.js"></script>
   <script>

           // ============================================
        // MAIN APPLICATION CODE
        // ============================================

        // Global variables for partner registration
        let currentStep = 1;
        const selectedRegistrantType = 'partner';
        let selectedPackage = '';
        let selectedPackageId = null;
        let selectedPaymentMethod = '';
        let phoneInputs = [];
        let uploadedLogoUrl = ''; // holds the uploaded company logo URL returned by /misc/upload-image
        let lastPartnerRegistrationResponse = null;
        let availablePackages = [];
        let selectedPackageDashboard = 'partners-dash.html'; // Default dashboard
        let partnerAccountId = null; // Store the partner ID after successful registration
        
        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        async function initializeApp() {
            try {

                 // Populate country dropdowns
        populateCountryDropdowns();
        
                // Fetch packages from backend and render them
                await fetchAndRenderPackages();

                // Initialize phone inputs
                initializePhoneInputs();

                // Set up event listeners
                setupEventListeners();

                // Setup package selection (after dynamic rendering)
                setupPackageSelection();

                // Setup payment section
                setupPaymentSection();

                // Check for payment callback/return from Flutterwave
                await handlePaymentCallback();

            } catch (error) {
                console.error('Error initializing app:', error);
            }
        }

        async function handlePaymentCallback() {
            try {
                // Check if returning from Flutterwave payment
                const urlParams = new URLSearchParams(window.location.search);
                // Prefer Flutterwave-generated identifiers
                const flwRef = urlParams.get('flw_ref');
                const transactionId = urlParams.get('transaction_id') || urlParams.get('transactionId');
                const txRef = urlParams.get('tx_ref');
                const status = urlParams.get('status');

                // Fallback to any previously stored reference (if present)
                const storedRef = sessionStorage.getItem('lastTxRef');
                if (!flwRef && !transactionId && !txRef && !status && !storedRef) return;

                console.log('=== PAYMENT CALLBACK HANDLER ===');
                console.log('URL flw_ref:', flwRef);
                console.log('URL transaction_id:', transactionId);
                console.log('URL tx_ref:', txRef);
                console.log('URL status:', status);

                // Prefer using `transaction_id` for verification, then `flw_ref`, then fall back to `tx_ref` or stored reference
                const verifyIdentifier = transactionId || flwRef || txRef || storedRef;
                if (verifyIdentifier) {
                    console.log('Verifying payment with identifier (transaction_id preferred):', verifyIdentifier);

                    // Ensure we have the package id (fall back to sessionStorage if needed)
                    const storedPackageId = sessionStorage.getItem('selectedPackageId');
                    const packageIdForVerify = selectedPackageId || (storedPackageId ? Number(storedPackageId) : null);

                    // Call backend to verify payment using `transaction_id` as the primary parameter
                    try {
                        console.log('Making verification request to: /payments/verify-event-partner-payment with reference=' + transactionId + ' and packageId=' + packageIdForVerify);
                        // Build query params; include event_package_id only if available
                        const queryParams = `reference=${encodeURIComponent(transactionId)}` + (packageIdForVerify ? `&event_package_id=${encodeURIComponent(packageIdForVerify)}` : '');
                        const verifyResponse = await window.apiClient.get(`/payments/verify-event-partner-payment?${queryParams}`);
                        const verifyData = verifyResponse && (verifyResponse.data || verifyResponse);
                        
                        console.log('Payment verification response:', verifyData);
                        console.log('Response keys:', verifyData ? Object.keys(verifyData) : 'null');
                        
                        // Check if payment is successful
                        // Handle multiple response formats for success
                        let isPaymentSuccessful = false;
                        
                        // Format 1: {status: 'success'}
                        if (verifyData && verifyData.status === 'success') {
                            isPaymentSuccessful = true;
                            console.log('✓ Payment verified successfully (status === success)');
                        }
                        // Format 2: {success: true}
                        else if (verifyData && verifyData.success === true) {
                            isPaymentSuccessful = true;
                            console.log('✓ Payment verified successfully (success === true)');
                        }
                        // Format 3: {data: {status: 'success'}}
                        else if (verifyData && verifyData.data && verifyData.data.status === 'success') {
                            isPaymentSuccessful = true;
                            console.log('✓ Payment verified successfully (data.status === success)');
                        }
                        // Format 4: {data: {success: true}}
                        else if (verifyData && verifyData.data && verifyData.data.success === true) {
                            isPaymentSuccessful = true;
                            console.log('✓ Payment verified successfully (data.success === true)');
                        }
                        // Format 5: {verified: true}
                        else if (verifyData && verifyData.verified === true) {
                            isPaymentSuccessful = true;
                            console.log('✓ Payment verified successfully (verified === true)');
                        }
                        // Format 6: Trust URL status parameter as fallback
                        else if (status === 'successful' || status === 'completed') {
                            isPaymentSuccessful = true;
                            console.log('✓ Payment completed (from URL parameter)');
                        }
                        
                        if (isPaymentSuccessful) {
                            completePaymentFlow(verifyIdentifier);
                        } else {
                            console.warn('Payment verification returned unexpected status:', verifyData);
                        }
                    } catch (verifyErr) {
                        console.warn('Payment verification API call failed:', verifyErr);
                        console.warn('Error status:', verifyErr.response?.status);
                        console.warn('Error data:', verifyErr.response?.data);
                        
                        // Fallback: if verification fails but we have URL status, trust it
                        if (status === 'successful' || status === 'completed') {
                            console.log('Verification failed, but trusting URL status parameter');
                            completePaymentFlow(verifyIdentifier);
                        }
                        // Otherwise don't show error - user may have just navigated back
                    }
                }
            } catch (err) {
                console.error('Error in payment callback handler:', err);
            }
        }

        function completePaymentFlow(txRef) {
            console.log('=== COMPLETING PAYMENT FLOW ===');
            
            // Update Flutterwave button to show paid status
            const payBtn = document.getElementById('pay-with-flutterwave');
            if (payBtn) {
                payBtn.disabled = true;
                payBtn.innerHTML = '<i class="fas fa-check-circle me-2"></i>Payment Completed';
                payBtn.className = 'btn btn-success';
                console.log('Updated button to: Payment Completed');
            }
            
            // Store payment status
            sessionStorage.setItem('paymentCompleted', 'true');
            sessionStorage.setItem('completedTxRef', txRef);
            
            // Update confirmation section with payment details
            updateConfirmationSection();
            
            // Show confirmation section
            showStep(4);
            
            // Show success notification
            showNotification('Payment completed successfully! Thank you for your registration.', 'success');
            
            console.log('Payment flow completed successfully');
        }

        // Fetch partner packages from backend and render into the .package-cards container
        async function fetchAndRenderPackages() {
            const container = document.querySelector('.package-cards');
            if (!container) return;

            // Clear container
            container.innerHTML = '';

            // Try to fetch packages from backend; fall back to hardcoded if API fails
            let fetchedPackages = [];
            try {
                const resp = await window.apiClient.get('/packages/event-partner-packages');
                const respData = resp && (resp.data || resp);
                if (respData && Array.isArray(respData.data)) {
                    fetchedPackages = respData.data;
                } else if (Array.isArray(respData)) {
                    fetchedPackages = respData;
                }
            } catch (err) {
                console.warn('Failed to fetch packages from API', err);
            }

            // Normalize packages into the shape the UI expects
            availablePackages = (fetchedPackages || []).map(pkg => {
                const max_count = Number(pkg.total_slot ?? pkg.max_count ?? 0);
                const remaining = Number(typeof pkg.remaining_slot !== 'undefined' ? pkg.remaining_slot : (pkg.remainingSlots ?? null) ?? (max_count === 0 ? 0 : max_count - (pkg.current_count || 0)));
                const current_count = max_count === 0 ? 0 : Math.max(0, max_count - remaining);

                return {
                    id: pkg.id,
                    slug: pkg.slug,
                    name: pkg.title || pkg.name || pkg.slug,
                    title: pkg.title || pkg.name,
                    price: Number(pkg.price ?? pkg.investment ?? 0),
                    investment: Number(pkg.investment ?? pkg.price ?? 0),
                    description: pkg.description,
                    features: Array.isArray(pkg.features) ? pkg.features : (pkg.features ? [pkg.features] : []),
                    max_count,
                    current_count,
                    remaining_slot: remaining,
                    total_slot: max_count,
                    limitedText: pkg.limitedText ?? pkg.limited_text ?? null,
                    redirect_dashboard: pkg.redirect_dashboard || pkg.dashboard_url || 'partners-dash.html',
                    is_exhibitor: pkg.is_exhibitor || false,
                    force_closed: pkg.force_closed || false
                };
            });

            // Render each package
            availablePackages.forEach(pkg => {
                const card = document.createElement('div');
                card.className = 'package-card';
                card.setAttribute('data-package', pkg.slug);
                card.setAttribute('data-package-id', String(pkg.id));
                
                const price = pkg.investment || pkg.price || 0;
                const priceText = Number(price).toLocaleString();
                
                // Features HTML
                let featuresHtml = '';
                if (Array.isArray(pkg.features) && pkg.features.length > 0) {
                    featuresHtml = '<ul>' + pkg.features.map(f => `<li>${f}</li>`).join('') + '</ul>';
                } else if (pkg.description) {
                    featuresHtml = `<p class="package-description">${pkg.description}</p>`;
                }
                
                // Availability
                const maxCount = Number(pkg.total_slot || pkg.max_count || 0);
                const remaining = Number(pkg.remaining_slot ?? (maxCount === 0 ? 0 : maxCount - (pkg.current_count || 0)));
                const isAvailable = maxCount === 0 || remaining > 0;
                
                let limitedText = '';
                if (!isAvailable) {
                    limitedText = `<div class="limited" style="color: #dc3545;">Fully Booked</div>`;
                    card.classList.add('disabled');
                    card.style.opacity = '0.6';
                    card.style.cursor = 'not-allowed';
                } else if (maxCount > 0) {
                    limitedText = `<div class="limited">${remaining} of ${maxCount} slots remaining</div>`;
                } else {
                    limitedText = `<div class="limited">Unlimited slots available</div>`;
                }
                
                // If server provided a custom limitedText, prefer it
                if (pkg.limitedText) {
                    limitedText = `<div class="limited">${pkg.limitedText}</div>`;
                }

                // Card HTML
                card.innerHTML = `
                    <h4>${pkg.title || pkg.name}</h4>
                    <div class="price">₦${priceText}</div>
                    ${featuresHtml}
                    ${limitedText}
                `;

                container.appendChild(card);
            });

            // Add refresh / loaded status indicator
            updateRefreshStatus();
        }
        
        
        
        // Update refresh status indicator
        function updateRefreshStatus() {
            let statusElement = document.getElementById('refresh-status');
            if (!statusElement) {
                const packageSection = document.querySelector('#package-section');
                if (packageSection) {
                    statusElement = document.createElement('div');
                    statusElement.id = 'refresh-status';
                    statusElement.className = 'text-center mt-3';
                    statusElement.style.cssText = `
                        font-size: 0.85rem;
                        color: #6c757d;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                    `;
                    
                    const icon = document.createElement('i');
                    icon.className = 'fas fa-check-circle';
                    icon.style.fontSize = '0.9rem';
                    
                    const text = document.createElement('span');
                    text.id = 'refresh-status-text';
                    text.textContent = 'Packages loaded';
                    
                    statusElement.appendChild(icon);
                    statusElement.appendChild(text);
                    
                    const packageCards = document.querySelector('.package-cards');
                    if (packageCards && packageCards.parentNode) {
                        packageCards.parentNode.insertBefore(statusElement, packageCards.nextSibling);
                    }
                }
            }
            
            if (statusElement) {
                const textElement = statusElement.querySelector('#refresh-status-text');
                if (textElement) {
                    const now = new Date();
                    const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'});
                    textElement.textContent = `Packages loaded | Last updated: ${timeString}`;
                }
            }
        }
        
        // Manual refresh packages function
        async function refreshPackages() {
            const refreshBtn = document.getElementById('refresh-packages-btn');
            if (refreshBtn) {
                const originalText = refreshBtn.innerHTML;
                refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
                refreshBtn.disabled = true;
                
                try {
                    await fetchAndRenderPackages();
                    
                    // Reset selection if the selected package is no longer available
                    if (selectedPackageId) {
                        const isAvailable = await checkPackageAvailability(selectedPackageId);
                        if (!isAvailable) {
                            selectedPackage = '';
                            selectedPackageId = null;
                            selectedPackageDashboard = 'partners-dash.html';
                            document.querySelectorAll('.package-card').forEach(c => c.classList.remove('selected'));
                            const continueBtn = document.getElementById('continue-to-payment-btn');
                            if (continueBtn) continueBtn.disabled = true;
                            
                            showNotification('Your selected package is no longer available. Please select a different package.', 'warning');
                        }
                    }
                    
                    // Reattach event listeners
                    setupPackageSelection();
                    
                    showNotification('Packages refreshed successfully!', 'success');
                } catch (err) {
                    console.error('Failed to refresh packages:', err);
                    showNotification('Failed to refresh packages. Please try again.', 'error');
                } finally {
                    refreshBtn.innerHTML = originalText;
                    refreshBtn.disabled = false;
                }
            }
        }
        
        // Check package availability function - FIXED VERSION
        async function checkPackageAvailability(packageId) {
            try {
                const resp = await window.apiClient.get(`/packages/check-availability/${packageId}`);
                const respData = resp && (resp.data || resp);
                return respData && respData.available !== false;
            } catch (err) {
                // If endpoint doesn't exist (404), fall back to local calculation
                if (err.status === 404 || err.response?.status === 404) {
                    console.log('Availability endpoint not found, using local calculation');
                    return checkLocalPackageAvailability(packageId);
                }
                console.error('Error checking package availability:', err);
                return true; // Default to available on error
            }
        }
        
        function initializePhoneInputs() {
            const phoneInputIds = ['workPhone'];
            
            phoneInputs = phoneInputs || [];
            
            phoneInputIds.forEach(id => {
                const input = document.getElementById(id);
                if (input && window.intlTelInput) {
                    try {
                        const iti = window.intlTelInput(input, {
                            initialCountry: "ng",
                            separateDialCode: true,
                            utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
                        });
                        phoneInputs.push({ id, iti });
                    } catch (error) {
                        console.error(`Error initializing phone input ${id}:`, error);
                    }
                }
            });
        }
        
        function setupEventListeners() {
            // Password toggle functionality
            const togglePassword = document.getElementById('togglePassword');
            const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            
            if (togglePassword && passwordInput) {
                togglePassword.addEventListener('click', function() {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            }
            
            if (toggleConfirmPassword && confirmPasswordInput) {
                toggleConfirmPassword.addEventListener('click', function() {
                    const type = confirmPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    confirmPasswordInput.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            }
            
            // Navigation buttons
            const continueToPackageBtn = document.getElementById('continue-to-package-btn');
            if (continueToPackageBtn) {
                continueToPackageBtn.addEventListener('click', function() {
                    if (validateMainForm()) {
                        showStep(2);
                    }
                });
            }
            
            const backToMainFormBtn = document.getElementById('back-to-main-form-btn');
            if (backToMainFormBtn) {
                backToMainFormBtn.addEventListener('click', function() {
                    showStep(1);
                });
            }
            
            const continueToPaymentBtn = document.getElementById('continue-to-payment-btn');
            if (continueToPaymentBtn) {
                continueToPaymentBtn.addEventListener('click', async function() {
                    if (!selectedPackageId) {
                        showNotification('Please select a package first', 'warning');
                        return;
                    }

                    // Proceed with validation
                    if (!validatePackageSelection()) return;

                    // Create partner account before proceeding to payment
                    try {
                        this.disabled = true;
                        this.classList.add('btn-loading');
                        
                        await registerEventPartnerOnPackageSelect();
                        showStep(3);
                    } catch (err) {
                        console.error('Error creating partner account:', err);
                        showNotification('Failed to create partner account. Please check your information and try again.', 'error');
                    } finally {
                        this.disabled = false;
                        this.classList.remove('btn-loading');
                    }
                });
            }
            
            const backToPackageBtn = document.getElementById('back-to-package-btn');
            if (backToPackageBtn) {
                backToPackageBtn.addEventListener('click', function() {
                    showStep(2);
                });
            }
            
            const completeRegistrationBtn = document.getElementById('complete-registration-btn');
            if (completeRegistrationBtn) {
                completeRegistrationBtn.addEventListener('click', async function() {
                    if (validatePaymentForm()) {
                        // For Flutterwave, don't process here - user clicks the Flutterwave button
                        if (selectedPaymentMethod === 'flutterwave') {
                            showNotification('Please click the "Pay with Flutterwave" button to proceed to payment', 'info');
                            return;
                        }
                        // For bank transfer, process immediately
                        await processRegistration();
                    }
                });
            }
            
            // Flutterwave payment button
            const flutterwaveBtn = document.getElementById('pay-with-flutterwave');
            if (flutterwaveBtn) {
                flutterwaveBtn.addEventListener('click', function() {
                    processFlutterwavePayment();
                });
            }
            const logoInput = document.getElementById('companyLogo');
    const logoPreview = document.getElementById('logoPreview');
    const logoPreviewContainer = document.getElementById('logoPreviewContainer');

    if (logoInput) {
        logoInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    logoPreview.setAttribute('src', e.target.result);
                    logoPreviewContainer.style.display = 'block';
                }
                reader.readAsDataURL(file);
            } else {
                logoPreviewContainer.style.display = 'none';
            }
        });
    }

            
            // Dashboard button - Updated to use dynamic dashboard URL
            const goToDashboardBtn = document.getElementById('go-to-dashboard-btn');
            if (goToDashboardBtn) {
                goToDashboardBtn.addEventListener('click', function() {
                    redirectToDashboard();
                });
            }
        }
        
        function setupPackageSelection() {
            const packageCards = document.querySelectorAll('.package-card:not(.disabled)');
            packageCards.forEach(card => {
                card.addEventListener('click', function() {
                    // Skip disabled packages
                    if (this.classList.contains('disabled')) {
                        showNotification('This package is not available for selection', 'warning');
                        return;
                    }
                    
                    // Remove selected class from all cards
                    document.querySelectorAll('.package-card').forEach(c => c.classList.remove('selected'));
                    
                    // Add selected class to clicked card
                    this.classList.add('selected');
                    
                    // Store selected package (slug) and id
                    selectedPackage = this.getAttribute('data-package');
                    const pkgIdAttr = this.getAttribute('data-package-id');
                    selectedPackageId = pkgIdAttr ? Number(pkgIdAttr) : null;
                    
                    // Get package details - FIXED: Use the package from availablePackages array
                    const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                    if (selectedPkg) {
                        console.log('Selected package:', selectedPkg.name || selectedPkg.title, 'Price:', selectedPkg.price);
                        
                        // Store the dashboard URL for this package
                        selectedPackageDashboard = selectedPkg.redirect_dashboard || selectedPkg.dashboard_url || 'partners-dash.html';
                        
                        // Check if this is an exhibitor package
                        if (selectedPkg.is_exhibitor) {
                            console.log('This is an exhibitor package. Will redirect partners dashboard.');
                        }
                    } else {
                        console.warn('Selected package not found in availablePackages array');
                        selectedPackageDashboard = 'partners-dash.html';
                    }
                    
                    // Enable continue button
                    const continueBtn = document.getElementById('continue-to-payment-btn');
                    if (continueBtn) {
                        continueBtn.disabled = false;
                    }
                    
                    showNotification(`Selected: ${selectedPackage} package`, 'success');
                });
            });
        }
        // Country list for dropdowns 
const countries = [
    "Nigeria", "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia", 
    "Australia", "Austria", "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", 
    "Belize", "Benin", "Bhutan", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria", 
    "Burkina Faso", "Burundi", "Cabo Verde", "Cambodia", "Cameroon", "Canada", "Central African Republic", "Chad", 
    "Chile", "China", "Colombia", "Comoros", "Congo", "Costa Rica", "Croatia", "Cuba", "Cyprus", "Czech Republic", 
    "Denmark", "Djibouti", "Dominica", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea", 
    "Eritrea", "Estonia", "Eswatini", "Ethiopia", "Fiji", "Finland", "France", "Gabon", "Gambia", "Georgia", 
    "Germany", "Ghana", "Greece", "Grenada", "Guatemala", "Guinea", "Guinea-Bissau", "Guyana", "Haiti", "Honduras", 
    "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Israel", "Italy", "Jamaica", "Japan", 
    "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Korea, North", "Korea, South", "Kosovo", "Kuwait", "Kyrgyzstan", 
    "Laos", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libya", "Liechtenstein", "Lithuania", "Luxembourg", "Madagascar", 
    "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Mauritania", "Mauritius", "Mexico", 
    "Micronesia", "Moldova", "Monaco", "Mongolia", "Montenegro", "Morocco", "Mozambique", "Myanmar", "Namibia", 
    "Nauru", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", "North Macedonia", "Norway", 
    "Oman", "Pakistan", "Palau", "Palestine", "Panama", "Papua New Guinea", "Paraguay", "Peru", "Philippines", 
    "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saint Kitts and Nevis", "Saint Lucia", 
    "Saint Vincent and the Grenadines", "Samoa", "San Marino", "Sao Tome and Principe", "Saudi Arabia", "Senegal", 
    "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "Solomon Islands", "Somalia", 
    "South Africa", "South Sudan", "Spain", "Sri Lanka", "Sudan", "Suriname", "Sweden", "Switzerland", "Syria", 
    "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Timor-Leste", "Togo", "Tonga", "Trinidad and Tobago", "Tunisia", 
    "Turkey", "Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", 
    "Uruguay", "Uzbekistan", "Vanuatu", "Vatican City", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"
];

function populateCountryDropdowns() {
    const countrySelectors = ['country'];
    
    countrySelectors.forEach(selector => {
        const select = document.getElementById(selector);
        if (select) {
            const placeholder = select.options.length ? select.options[0].outerHTML : '<option value="" disabled>Select your country</option>';
            select.innerHTML = placeholder;
            
            countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                select.appendChild(option);
            });
            
            Array.from(select.options).forEach(opt => {
                if (!opt.value || opt.value.trim() === '') {
                    opt.value = opt.textContent.trim();
                }
            });
            
            // Set empty default
            select.selectedIndex = 0;
        }
    });
}

        async function registerEventPartnerOnPackageSelect() {
            try {
                // Get form data
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const prefix = document.getElementById('prefix').value;
                const firstName = document.getElementById('firstName').value;
                const lastName = document.getElementById('lastName').value;
                const country = document.getElementById('country').value;
                const jobTitle = document.getElementById('jobTitle').value;
                const organisation = document.getElementById('organisation').value;
                const workPhoneInput = phoneInputs.find(p => p.id === 'workPhone');
                const workPhone = workPhoneInput && workPhoneInput.iti 
                    ? workPhoneInput.iti.getNumber() 
                    : document.getElementById('workPhone').value;
                
                // Prepare registration payload
                const registrationPayload = {
                    contactEmail: email,
                    password,
                    prefix,
                    contactFirstName: firstName,
                    contactLastName: lastName,
                    country,
                    jobTitle: jobTitle,
                    companyName: organisation,
                    contactPhone: workPhone
                };
                
                console.log('Creating partner account with:', registrationPayload);
                
                // Call backend partner register endpoint
                const response = await window.apiClient.post('/auth/partner-register', registrationPayload);
                const respData = response && (response.data || response);
                
                console.log('Partner registration response:', respData);
                
                // Handle both response formats:
                // Format 1: {data: {id, token}}
                // Format 2: {partner: {id}, token}
                let partnerId = null;
                let token = null;
                
                if (respData && respData.data && respData.data.id) {
                    // Format 1: Standard format
                    partnerId = respData.data.id;
                    token = respData.data.token;
                } else if (respData && respData.partner && respData.partner.id) {
                    // Format 2: Actual backend format
                    partnerId = respData.partner.id;
                    token = respData.token;
                }
                
                if (partnerId) {
                    partnerAccountId = partnerId;
                    lastPartnerRegistrationResponse = respData;
                    
                    // Persist key partner details to sessionStorage so they can be shown after redirect/verification
                    try {
                        sessionStorage.setItem('partnerEmail', String(email || ''));
                        sessionStorage.setItem('partnerFirstName', String(firstName || ''));
                        sessionStorage.setItem('partnerLastName', String(lastName || ''));
                        sessionStorage.setItem('partnerOrganisation', String(organisation || ''));
                    } catch (e) {
                        console.warn('Could not persist partner details to sessionStorage', e);
                    }

                    // Store auth token if provided
                    if (token) {
                        localStorage.setItem('authUser', JSON.stringify({ 
                            token: token,
                            id: partnerId
                        }));
                        console.log('Token stored in localStorage:', token.substring(0, 20) + '...');
                    }
                    
                    showNotification('Partner account created successfully!', 'success');
                    return respData;
                } else {
                    throw new Error('Invalid response from partner registration - missing partner ID');
                }
            } catch (err) {
                console.error('Partner registration error:', err);
                showNotification(err.message || 'Failed to create partner account', 'error');
                throw err;
            }
        }
        
        function setupPaymentSection() {
            const paymentOptions = document.querySelectorAll('.payment-option input');
            paymentOptions.forEach(option => {
                option.addEventListener('change', function() {
                    if (this.checked) {
                        // Remove selected class from all payment options
                        document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
                        
                        // Add selected class to parent
                        this.parentElement.classList.add('selected');
                        
                        // Update selected payment method
                        selectedPaymentMethod = this.value;
                        
                        // Show/hide payment forms based on selection
                        document.getElementById('bank-transfer-form').style.display = 
                            selectedPaymentMethod === 'bank-transfer' ? 'block' : 'none';
                        document.getElementById('flutterwave-form').style.display = 
                            selectedPaymentMethod === 'flutterwave' ? 'block' : 'none';
                        
                        // Update amount display
                        const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                        if (selectedPkg) {
                            const amount = Number(selectedPkg.investment || selectedPkg.price || 0);
                            
                            // Update bank transfer amount
                            const bankTransferAmount = document.getElementById('bank-transfer-amount');
                            if (bankTransferAmount) {
                                bankTransferAmount.innerHTML = `<div class="payment-amount"><strong>Amount Due:</strong> ₦${amount.toLocaleString()} NGN</div>`;
                            }
                            
                            // Update Flutterwave amount
                            const flutterwaveAmount = document.getElementById('flutterwave-amount');
                            if (flutterwaveAmount) {
                                flutterwaveAmount.innerHTML = `<div class="payment-amount"><strong>Amount Due:</strong> ₦${amount.toLocaleString()} NGN</div>`;
                            }
                        }
                        
                        // Enable complete button
                        const completeBtn = document.getElementById('complete-registration-btn');
                        if (completeBtn) completeBtn.disabled = false;
                    }
                });
            });
        }
        
        function validateMainForm() {
            let isValid = true;
            
            // Email validation
            const email = document.getElementById('email').value;
            if (!email || !isValidEmail(email)) {
                showError('email-error', 'Please enter a valid email address');
                isValid = false;
            } else {
                hideError('email-error');
            }
            
            // Password validation
            const password = document.getElementById('password').value;
            if (!password || password.length < 8) {
                showError('password-error', 'Password must be at least 8 characters long');
                isValid = false;
            } else {
                hideError('password-error');
            }
            
            // Confirm password validation
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (!confirmPassword || password !== confirmPassword) {
                showError('confirmPassword-error', 'Passwords do not match');
                isValid = false;
            } else {
                hideError('confirmPassword-error');
            }
            
            // Required fields validation
            const requiredFields = [
                'prefix', 'firstName', 'lastName', 'country', 
                'jobTitle', 'organisation', 'workPhone'
            ];
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (!element || !element.value.trim()) {
                    showError(`${field}-error`, 'This field is required');
                    isValid = false;
                } else {
                    hideError(`${field}-error`);
                }
            });
            
            // Data sharing agreement validation
            const dataSharing = document.querySelector('input[name="dataSharing"]:checked');
            if (!dataSharing) {
                showNotification('Please select an option for data sharing agreement', 'warning');
                isValid = false;
            }
            
            // Terms and conditions validation
            const terms = document.getElementById('terms');
            if (!terms || !terms.checked) {
                showNotification('You must agree to the terms and conditions', 'warning');
                isValid = false;
            }
            
            return isValid;
        }
        
        function validatePackageSelection() {
            if (!selectedPackage) {
                showNotification('Please select a partnership package', 'warning');
                return false;
            }
            return true;
        }
        
        function validatePaymentForm() {
            if (!selectedPaymentMethod) {
                showNotification('Please select a payment method', 'warning');
                return false;
            }
            
            // Validate bank transfer receipt upload - ONLY for bank transfers
            if (selectedPaymentMethod === 'bank-transfer') {
                const paymentReceipt = document.getElementById('paymentReceipt');
                if (!paymentReceipt || !paymentReceipt.files || paymentReceipt.files.length === 0) {
                    showError('paymentReceipt-error', 'Please upload your payment receipt');
                    return false;
                }
                
                // Validate file size (5MB max)
                const file = paymentReceipt.files[0];
                const maxSize = 5 * 1024 * 1024; // 5MB in bytes
                if (file.size > maxSize) {
                    showError('paymentReceipt-error', 'File size must be less than 5MB');
                    return false;
                }
                
                // Validate file type
                const allowedTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
                if (!allowedTypes.includes(file.type)) {
                    showError('paymentReceipt-error', 'Please upload a valid file type (PDF, JPG, PNG, DOC)');
                    return false;
                }
                
                hideError('paymentReceipt-error');
            }
            
            return true;
        }
        
        async function processFlutterwavePayment() {
            const payBtn = document.getElementById('pay-with-flutterwave');
            if (!payBtn) {
                console.error('Pay button not found');
                showNotification('Payment button not found', 'error');
                return;
            }
            
            try {
                console.log('=== FLUTTERWAVE PAYMENT INITIALIZATION START ===');
                
                payBtn.disabled = true;
                payBtn.classList.add('btn-loading');
                
                // Ensure partner account exists
                if (!partnerAccountId) {
                    console.error('Partner account ID not found:', partnerAccountId);
                    showNotification('Error: Partner account not created. Please go back and complete registration.', 'error');
                    return;
                }
                
                console.log('Partner Account ID:', partnerAccountId);
                
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                if (!selectedPkg) {
                    console.error('Selected package not found. Package ID:', selectedPackageId);
                    showNotification('Error: Package not found', 'error');
                    return;
                }
                
                console.log('Selected Package:', selectedPkg);
                
                // Prepare payment initialization payload
                // Note: deliberately NOT sending a customer-generated `tx_ref` so Flutterwave will assign its own reference.
                const paymentPayload = {
                    event_package_id: selectedPackageId,
                    currency: 'NGN'
                };
                
                console.log('Payment Payload:', paymentPayload);
                console.log('Making request to: /payments/initialize-event-partner-payment');
                
                // Call backend payment initialization endpoint
                const response = await window.apiClient.post('/payments/initialize-event-partner-payment', paymentPayload);
                
                console.log('Raw response:', response);
                
                const respData = response && (response.data || response);
                
                console.log('Full payment response:', respData);
                console.log('Response type:', typeof respData);
                console.log('Response keys:', respData ? Object.keys(respData) : 'null');
                
                // Handle multiple possible response formats
                let paymentUrl = null;
                
                // Format 0: {data: {data: {link}}} - Actual backend format
                if (respData && respData.data && respData.data.data && respData.data.data.link) {
                    paymentUrl = respData.data.data.link;
                    console.log('✓ Found link in respData.data.data.link');
                }
                // Format 1: {data: {authorization_url}}
                else if (respData && respData.data && respData.data.authorization_url) {
                    paymentUrl = respData.data.authorization_url;
                    console.log('✓ Found authorization_url in respData.data.authorization_url');
                }
                // Format 2: {authorization_url} - direct at root
                else if (respData && respData.authorization_url) {
                    paymentUrl = respData.authorization_url;
                    console.log('✓ Found authorization_url in respData.authorization_url');
                }
                // Format 3: {data: {url}}
                else if (respData && respData.data && respData.data.url) {
                    paymentUrl = respData.data.url;
                    console.log('✓ Found url in respData.data.url');
                }
                // Format 4: {url} - direct at root
                else if (respData && respData.url) {
                    paymentUrl = respData.url;
                    console.log('✓ Found url in respData.url');
                }
                // Format 5: {payment_link}
                else if (respData && respData.payment_link) {
                    paymentUrl = respData.payment_link;
                    console.log('✓ Found payment_link in respData.payment_link');
                }
                // Format 6: {link}
                else if (respData && respData.link) {
                    paymentUrl = respData.link;
                    console.log('✓ Found link in respData.link');
                }
                
                if (paymentUrl) {
                    console.log('Payment URL extracted successfully:', paymentUrl);
                    console.log('=== PAYMENT URL READY - REDIRECTING ===');
                    
                    showNotification('Redirecting to Flutterwave payment...', 'success');
                    
                    // Store partner context for post-payment handling
                    sessionStorage.setItem('partnerId', String(partnerAccountId));
                    sessionStorage.setItem('selectedPackageId', String(selectedPackageId));
                    
                    // Append callback URL to redirect user back after payment. Do NOT include a merchant tx_ref here;
                    // Flutterwave will append its own reference parameters (e.g. flw_ref) to the callback URL.
                    const callbackUrl = `${window.location.origin}${window.location.pathname}?status=successful`;
                    const fullPaymentUrl = `${paymentUrl}${paymentUrl.includes('?') ? '&' : '?'}callback=${encodeURIComponent(callbackUrl)}`;
                    
                    // Redirect after a short delay to allow notification to be seen
                    setTimeout(() => {
                        console.log('Performing redirect to:', fullPaymentUrl);
                        window.location.href = fullPaymentUrl;
                    }, 1500);
                } else {
                    console.error('Payment URL not found in response');
                    console.error('Response structure:', JSON.stringify(respData, null, 2));
                    throw new Error('No payment URL found in server response. Check console for response structure.');
                }
            } catch (err) {
                console.error('=== FLUTTERWAVE PAYMENT ERROR ===');
                console.error('Error message:', err.message);
                console.error('Error:', err);
                if (err.response) {
                    console.error('Response status:', err.response.status);
                    console.error('Response data:', err.response.data);
                }
                console.error('Error stack:', err.stack);
                
                showNotification(err.message || 'Failed to initialize payment. Check console for details.', 'error');
            } finally {
                if (payBtn) {
                    payBtn.disabled = false;
                    payBtn.classList.remove('btn-loading');
                }
            }
        }
        
        async function processRegistration() {
            const completeBtn = document.getElementById('complete-registration-btn');
            
            if (completeBtn) {
                completeBtn.classList.add('btn-loading');
                completeBtn.disabled = true;
            }
            
            try {
                // Handle bank transfer payment
                if (selectedPaymentMethod === 'bank-transfer') {
                    // For bank transfer, we just show confirmation
                    // The payment will be verified later when admin receives the receipt
                    
                    console.log('Processing bank transfer registration');
                    
                    // Update confirmation with actual data
                    updateConfirmationSection();
                    
                    // Show success
                    showNotification('Registration submitted! Please complete the bank transfer and await admin verification.', 'success');
                    
                    // Move to confirmation step
                    showStep(4);
                } else if (selectedPaymentMethod === 'flutterwave') {
                    // For Flutterwave, initiate payment
                    console.log('Redirecting to Flutterwave payment');
                    await processFlutterwavePayment();
                    // User will be redirected to Flutterwave, so we don't need to continue here
                } else {
                    showNotification('Please select a payment method', 'warning');
                }
                        
            } catch (err) {
                console.error('Registration processing error:', err);
                showNotification(err.message || 'Failed to process registration', 'error');
            } finally {
                if (completeBtn) {
                    completeBtn.classList.remove('btn-loading');
                    completeBtn.disabled = false;
                }
            }
        }
        
        function updateConfirmationSection() {
            // Prefer current form values, otherwise fall back to sessionStorage values saved during registration
            const email = document.getElementById('email')?.value || sessionStorage.getItem('partnerEmail') || '';
            const firstName = document.getElementById('firstName')?.value || sessionStorage.getItem('partnerFirstName') || '';
            const lastName = document.getElementById('lastName')?.value || sessionStorage.getItem('partnerLastName') || '';
            const organisation = document.getElementById('organisation')?.value || sessionStorage.getItem('partnerOrganisation') || '';
            
            const confirmationEmail = document.getElementById('confirmation-email');
            const confirmationEmailText = document.getElementById('confirmation-email-text');
            const confirmationName = document.getElementById('confirmation-name');
            const confirmationType = document.getElementById('confirmation-type');
            const confirmationPackage = document.getElementById('confirmation-package');
            const confirmationPayment = document.getElementById('confirmation-payment');
            const confirmationId = document.getElementById('confirmation-id');
            
            // Generate or update registration ID
            if (confirmationId) {
                // Use the payment reference (completedTxRef) as the registration ID when available
                const completedRef = sessionStorage.getItem('completedTxRef');
                if (completedRef) {
                    confirmationId.textContent = String(completedRef);
                } else if (partnerAccountId) {
                    confirmationId.textContent = `ICSC2026-${String(partnerAccountId).padStart(6, '0')}`;
                } else {
                    confirmationId.textContent = `ICSC2026-${Date.now().toString().slice(-6)}`;
                }
            }
            
            // Update contact information
            if (confirmationEmail) confirmationEmail.textContent = email;
            if (confirmationEmailText) confirmationEmailText.textContent = email;
            if (confirmationName) confirmationName.textContent = `${firstName} ${lastName}`.trim() || organisation;
            if (confirmationType) confirmationType.textContent = 'Partner';
            
            // Update package information
            if (confirmationPackage) {
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                if (selectedPkg) {
                    const packageName = selectedPkg.name || selectedPkg.title || selectedPackage;
                    const packagePrice = Number(selectedPkg.investment || selectedPkg.price || 0);
                    confirmationPackage.textContent = `${packageName} - ₦${packagePrice.toLocaleString()} NGN`;
                } else {
                    const packageNames = {
                        'bronze-partner': 'Bronze Partner',
                        'silver-partner': 'Silver Partner', 
                        'gold-partner': 'Gold Partner',
                        'diamond-partner': 'Diamond Partner'
                    };
                    confirmationPackage.textContent = packageNames[selectedPackage] || selectedPackage;
                }
            }
            
            // Update payment status
            if (confirmationPayment) {
                // Check if payment was completed
                const paymentCompleted = sessionStorage.getItem('paymentCompleted') === 'true';
                
                if (paymentCompleted) {
                    confirmationPayment.innerHTML = '<span style="color: #28a745; font-weight: bold;"><i class="fas fa-check-circle me-2"></i>Payment Completed</span>';
                } else if (selectedPaymentMethod === 'bank-transfer') {
                    confirmationPayment.textContent = 'Bank Transfer (Pending Verification)';
                } else if (selectedPaymentMethod === 'flutterwave') {
                    confirmationPayment.textContent = 'Flutterwave (Payment Completed)';
                } else {
                    confirmationPayment.textContent = 'Pending';
                }
            }
            
            // Update dashboard button text based on selected package
            const goToDashboardBtn = document.getElementById('go-to-dashboard-btn');
            if (goToDashboardBtn) {
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                if (selectedPkg && (selectedPkg.is_exhibitor || selectedPackage === 'bronze-partner')) {
                    goToDashboardBtn.innerHTML = '<i class="fas fa-external-link-alt me-2"></i>Go to Exhibitor Dashboard';
                } else {
                    goToDashboardBtn.innerHTML = '<i class="fas fa-external-link-alt me-2"></i>Go to Partner Dashboard';
                }
            }
            
            console.log('Confirmation section updated with:', {
                partnerId: partnerAccountId,
                email,
                name: `${firstName} ${lastName}`,
                package: selectedPackage,
                paymentMethod: selectedPaymentMethod,
                paymentCompleted: sessionStorage.getItem('paymentCompleted')
            });
        }
        
        function redirectToDashboard() {
            // Show notification about mock mode
            showNotification(`In mock mode, would redirect to: ${selectedPackageDashboard}`, 'info');
            
            // In real implementation:
            // window.location.href = selectedPackageDashboard;
        }
        
        function showStep(step) {
            const sections = ['main-form-section', 'package-section', 'payment-section', 'confirmation-section'];
            
            sections.forEach(section => {
                const element = document.getElementById(section);
                if (element) {
                    element.style.display = 'none';
                }
            });
            
            let currentSection;
            if (step === 1) {
                currentSection = document.getElementById('main-form-section');
            } else if (step === 2) {
                currentSection = document.getElementById('package-section');
            } else if (step === 3) {
                currentSection = document.getElementById('payment-section');
            } else if (step === 4) {
                currentSection = document.getElementById('confirmation-section');
                
                // Show mock notice in confirmation if in mock mode
                if (typeof window.apiClient !== 'undefined' && window.apiClient.mockPackages) {
                    const mockNotice = document.getElementById('confirmation-mock-notice');
                    if (mockNotice) {
                        mockNotice.style.display = 'block';
                    }
                }
            }
            
            if (currentSection) {
                currentSection.style.display = 'block';
            }
            
            // Update current step
            currentStep = step;
            
            // No auto-refresh behavior for package section by design
            
            window.scrollTo(0, 0);
        }

        // Helper function to show notifications
        function showNotification(message, type = 'success', duration = 5000) {
            // Create notification element if it doesn't exist
            let notificationEl = document.getElementById('registration-notification');
            if (!notificationEl) {
                notificationEl = document.createElement('div');
                notificationEl.id = 'registration-notification';
                notificationEl.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 500;
                    z-index: 9999;
                    display: none;
                    max-width: 300px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                `;
                document.body.appendChild(notificationEl);
            }
            
            // Set notification style based on type
            const colors = {
                success: '#28a745',
                error: '#dc3545',
                warning: '#ffc107',
                info: '#17a2b8'
            };
            
            notificationEl.style.backgroundColor = colors[type] || colors.success;
            notificationEl.textContent = message;
            notificationEl.style.display = 'block';
            
            // Auto-hide after duration
            setTimeout(() => {
                notificationEl.style.display = 'none';
            }, duration);
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        function showError(errorId, message) {
            const errorElement = document.getElementById(errorId);
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.style.display = 'block';
                
                const inputId = errorId.replace('-error', '');
                const inputElement = document.getElementById(inputId);
                if (inputElement) {
                    inputElement.classList.add('error');
                }
            }
        }
        
        function hideError(errorId) {
            const errorElement = document.getElementById(errorId);
            if (errorElement) {
                errorElement.style.display = 'none';
                
                const inputId = errorId.replace('-error', '');
                const inputElement = document.getElementById(inputId);
                if (inputElement) {
                    inputElement.classList.remove('error');
                }
            }
        }
    </script>
</body>
</html>