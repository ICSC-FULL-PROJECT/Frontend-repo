<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICSC 2026 - Partner Registration</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,400italic,700italic" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css">
    <style>
        :root {
            --primary-color: #28a745;
            --primary-dark: #218838;
            --secondary-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --light-gray: #f8f9fa;
            --border-color: #e9ecef;
            --text-dark: #2c3e50;
            --text-light: #6c757d;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #ffffff;
            line-height: 1.6;
            color: var(--text-dark);
            margin: 0;
            padding: 0;
        }
        
        .site-background {
            background-color: #ffffff !important;
        }
        
        .navbar {
            background: white;
            border: none;
            margin-bottom: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 0.5rem 0;
        }
        
        .jumbotron {
            background-color: #ffffff;
            margin-bottom: 0;
            padding: 30px 0;
        }
        
        .logo img {
            max-height: 80px;
            width: auto;
        }
        
        .form-section {
            background: white;
            border-radius: 8px;
            padding: 25px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            width: 100%;
        }
        
        .has-star::after {
            content: " *";
            color: var(--danger-color);
        }
        
        .btn-standard {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            padding: 14px 25px;
            font-weight: bold;
            font-size: 1rem;
            border-radius: 8px;
            width: 100%;
            margin: 5px 0;
        }
        
        .btn-standard:hover {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            color: white;
        }
        
        .btn-outline-standard {
            background-color: transparent;
            border-color: var(--primary-color);
            color: var(--primary-color);
            padding: 14px 25px;
            font-weight: bold;
            border-radius: 8px;
            width: 100%;
            margin: 5px 0;
        }
        
        .btn-outline-standard:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .social-media-links a {
            color: var(--primary-color) !important;
        }
        
        .footer-container {
            background-color: var(--light-gray);
            padding: 30px 0;
            margin-top: 40px;
        }
        
        .help-block-error {
            color: var(--danger-color);
            font-size: 0.8em;
            display: none;
            margin-top: 5px;
        }
        
        .hint-block {
            font-size: 0.8em;
            color: var(--text-light);
            margin-top: 5px;
        }
        
        .form-group {
            margin-bottom: 1.2rem;
            position: relative;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            border: 1px solid #f5c6cb;
            display: none;
            font-size: 0.9rem;
        }
        
        input.error, select.error, textarea.error {
            border-color: var(--danger-color);
        }
        
        .confirmation-details {
            background: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .confirmation-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .confirmation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .confirmation-label {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .confirmation-value {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
            text-align: center;
            margin: 20px 0;
        }
        
        .package-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .package-card {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .package-card:hover {
            border-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.1);
        }
        
        .package-card.selected {
            border-color: var(--primary-color);
            background: #f8fff9;
        }
        
        .package-card h4 {
            margin-bottom: 12px;
            color: var(--text-dark);
            text-align: center;
            font-size: 1.2rem;
        }
        
        .package-card .price {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--success-color);
            text-align: center;
            margin: 12px 0;
        }
        
        .package-card ul {
            padding-left: 18px;
            margin-bottom: 12px;
        }
        
        .package-card li {
            margin-bottom: 6px;
            color: var(--text-light);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .package-card .limited {
            color: var(--danger-color);
            font-weight: bold;
            text-align: center;
            margin-top: 8px;
            font-size: 0.8rem;
        }
        
        .payment-section {
            background: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .payment-option {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            background: white;
        }
        
        .payment-option.selected {
            border-color: var(--primary-color);
            background: #f8fff9;
        }
        
        .payment-option input {
            margin-right: 10px;
        }
        
        .payment-option label {
            margin-bottom: 0;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .payment-form {
            margin-top: 15px;
            display: none;
        }
        
        .iti {
            width: 100%;
        }
        
        .phone-input-container {
            position: relative;
        }
        
        .phone-input-container .form-control {
            padding-left: 52px;
        }
        
        .pdf-viewer {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 18px;
            margin: 18px 0;
            background: var(--light-gray);
        }
        
        .pdf-viewer h5 {
            margin-bottom: 12px;
            color: var(--text-dark);
            font-size: 1.1rem;
        }
        
        .pdf-placeholder {
            background: white;
            border-radius: 6px;
            padding: 30px 20px;
            text-align: center;
            border: 2px dashed var(--border-color);
        }
        
        .pdf-placeholder i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 12px;
        }

        .sponsor-package-info {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 18px;
            margin: 18px 0;
            border-radius: 4px;
        }

        .sponsor-package-info h5 {
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            top: 38px;
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            z-index: 10;
        }

        .password-toggle:focus {
            outline: none;
        }

        .button-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .container {
            padding-left: 15px;
            padding-right: 15px;
            max-width: 100%;
        }
        
        .checkbox-group {
            background: var(--light-gray);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .checkbox-item {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .checkbox-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .checkbox-label {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
        }
        
        .checkbox-label input {
            margin-right: 10px;
            margin-top: 4px;
        }
        
        .checkbox-text {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .checkbox-note {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 5px;
            font-style: italic;
        }
        
        .newsletter-option {
            background: var(--light-gray);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    /* Notification styles for mock mode */
    .mock-notice {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 8px;
        padding: 12px 15px;
        margin-bottom: 20px;
        text-align: center;
        color: #856404;
    }
    
    .mock-notice i {
        margin-right: 8px;
    }
    
    .package-description {
        color: #666;
        font-size: 0.9rem;
        margin-bottom: 10px;
        line-height: 1.4;
    }
    
    /* Improved disabled package styling */
    .package-card.disabled {
        opacity: 0.6;
        cursor: not-allowed;
        position: relative;
    }
    
    .package-card.disabled::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 8px;
    }
    
    .limited {
        margin-top: 8px;
        font-size: 0.85rem;
        text-align: center;
        font-weight: 500;
        padding: 4px 8px;
        border-radius: 4px;
        background: #f8f9fa;
    }
    
    .payment-amount {
        background: #e8f5e9;
        padding: 10px 15px;
        border-radius: 6px;
        margin-bottom: 15px;
        border-left: 3px solid #28a745;
    }


        /* Fix for button layout issue */
        .content-section .container {
            position: relative;
            z-index: 1;
        }

        .form-section {
            position: relative;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1rem;
            }
            
            .jumbotron h1 {
                font-size: 1.5rem;
            }
            
            .jumbotron .lead {
                font-size: 0.9rem;
            }
            
            .form-section {
                padding: 20px 15px;
            }
            
            .package-card {
                padding: 15px;
            }
            
            .confirmation-details, .payment-section {
                padding: 15px;
            }
            
            .pdf-viewer {
                padding: 15px;
            }
            
            .btn-standard, .btn-outline-standard {
                padding: 12px 20px;
                font-size: 0.95rem;
            }
        }

        @media (max-width: 576px) {
            .package-card h4 {
                font-size: 1.1rem;
            }
            
            .success-message {
                padding: 15px;
            }
            
            .container {
                padding-left: 10px;
                padding-right: 10px;
            }
        }

        @media (min-width: 768px) {
            .package-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .button-container {
                flex-direction: row;
                justify-content: space-between;
            }
            
            .btn-standard, .btn-outline-standard {
                width: auto;
                margin: 0;
            }
        }

        @media (min-width: 992px) {
            .package-cards {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (hover: none) {
            .package-card:hover {
                transform: none;
                border-color: var(--border-color);
            }
            
            .package-card.selected {
                border-color: var(--primary-color);
                transform: scale(1.02);
            }
        }

        button:focus,
        input:focus,
        select:focus,
        textarea:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        .btn-loading {
            position: relative;
            color: transparent;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-right-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="standard-page">
    <!-- Navigation -->
    <div id="nav-wrap">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container">
                <div class="d-flex align-items-center">
                    <div class="logo me-3">
                        <img src="icsc-logos.png" alt="ICSC 2026" class="img-fluid">
                    </div>
                    <span class="navbar-brand mb-0 h1"></span>
                </div>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="login.html">SIGN IN</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="agenda.html">AGENDA</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>

    <!-- Header -->
    <div id="header-wrap" class="jumbotron site-background">
        <div class="container">
            <div class="text-center">
                <h1>INTERNATIONAL CIVIL SERVICE CONFERENCE (ICSC) 2026</h1>
                <p class="lead">Building Global Civil Service Excellence</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content-section">
        <div class="container">
            <div class="text-center mb-4">
                <p class="lead"><strong>To return to the International Civil Service Conference website please click <a href="Index.html" target="_blank">here</a>.</strong></p>
            </div>

            <!-- Single Comprehensive Form Section -->
            <div id="main-form-section" class="form-section">
                <h2 class="text-center mb-4">Partner Registration</h2>
                
                <form id="main-form">
                    <!-- Email and Password Section -->
                    <div class="form-group">
                        <label class="has-star" for="email">Email Address</label>
                        <input type="email" id="email" name="email" class="form-control" required>
                        <div class="help-block-error" id="email-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="password">Choose a Password</label>
                        <div class="position-relative">
                            <input type="password" id="password" name="password" class="form-control" required>
                            <button type="button" class="password-toggle" id="togglePassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="help-block-error" id="password-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="confirmPassword">Repeat Your Password</label>
                        <div class="position-relative">
                            <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
                            <button type="button" class="password-toggle" id="toggleConfirmPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="help-block-error" id="confirmPassword-error"></div>
                    </div>
                    
                    <!-- Company Information -->
                    <div class="form-group">
                        <label class="has-star" for="prefix">Prefix</label>
                        <select id="prefix" name="prefix" class="form-control" required>
                            <option value="">Please choose...</option>
                            <option value="Mr">Mr</option>
                            <option value="Mrs">Mrs</option>
                            <option value="Miss">Miss</option>
                            <option value="Ms">Ms</option>
                            <option value="Dr">Dr</option>
                            <option value="Prof">Prof</option>
                        </select>
                        <div class="help-block-error" id="prefix-error"></div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="has-star" for="firstName">First name</label>
                            <input type="text" id="firstName" name="firstName" class="form-control" required>
                            <div class="help-block-error" id="firstName-error"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="has-star" for="lastName">Last name</label>
                            <input type="text" id="lastName" name="lastName" class="form-control" required>
                            <div class="help-block-error" id="lastName-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
    <label class="has-star" for="country">Country</label>
    <select id="country" name="country" class="form-control" required>
        <option value="" disabled>Select your country</option>
    </select>
    <div class="help-block-error" id="country-error"></div>
</div>
                    <div class="form-group">
                        <label class="has-star" for="jobTitle">Job title</label>
                        <input type="text" id="jobTitle" name="jobTitle" class="form-control" required>
                        <div class="help-block-error" id="jobTitle-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="organisation">Organisation/MDA/Company</label>
                        <input type="text" id="organisation" name="organisation" class="form-control" required>
                        <div class="help-block-error" id="organisation-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="has-star" for="workPhone">Work phone</label>
                        <div class="phone-input-container">
                            <input type="tel" id="workPhone" name="workPhone" class="form-control" placeholder="0802 123 4567" required>
                        </div>
                        <div class="help-block-error" id="workPhone-error"></div>
                    </div>
                    
                    <!-- Data Sharing Agreement -->
                    <div class="checkbox-group">
                        <h5>I agree to my information being shared with third party partners and exhibitors of the International Civil Service Conference</h5>
                        
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="radio" name="dataSharing" value="yes" required>
                                <div class="checkbox-text">
                                    <strong>Yes, I agree to the data I have submitted being shared with the third party knowledge partners and exhibitors of International Civil Service Conference</strong>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="radio" name="dataSharing" value="no" required>
                                <div class="checkbox-text">
                                    <strong>No, I do not agree to share my data with relevant third party organisations</strong>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-note">
                            * Please note that in this instance 'data' refers to your name, job title, organisation, email address and contact number submitted as part of this registration form.
                        </div>
                        
                        <div class="checkbox-note">
                            * All third party knowledge partners and exhibitors of the inaugural International Civil Service Conference can be found <a href="#" target="_blank">here</a>
                        </div>
                    </div>
                    
                    <!-- Terms and Conditions -->
                    <div class="checkbox-group">
                        <h5>Terms and conditions</h5>
                        
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="checkbox" id="terms" name="terms" required>
                                <div class="checkbox-text">
                                    <strong>I have read and agree with the Terms and Conditions, and wish to register for International Civil Service Conference</strong>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-note">
                            * Terms and conditions for International Civil Service Conference can be found <a href="#" target="_blank">here</a>
                        </div>
                    </div>
                    
                    <!-- Newsletter Subscription -->
                    <div class="newsletter-option">
                        <div class="checkbox-item">
                            <label class="checkbox-label">
                                <input type="checkbox" id="newsletter" name="newsletter">
                                <div class="checkbox-text">
                                    <strong>Subscribe to our newsletter</strong><br>
                                    <span class="checkbox-note">Yes please, sign me up!</span>
                                </div>
                            </label>
                        </div>
                        
                        <div class="checkbox-note">
                            *Tick this box if you would like to have the weekly Global Government Forum newsletters sent directly to your inbox. It's free and if you change your mind you can unsubscribe at any time.
                        </div>
                    </div>
                </form>
                
                <div class="button-container">
                    <a href="register.html" class="btn btn-outline-standard">
                        <i class="fas fa-arrow-circle-left me-2"></i> Back to Registration Types
                    </a>
                    <button type="button" class="btn btn-standard" id="continue-to-package-btn">
                        Continue to Package Selection <i class="fas fa-arrow-circle-right ms-2"></i>
                    </button>
                </div>
            </div>

            <!-- Step 2: Package Selection Section -->
            <div id="package-section" class="form-section" style="display: none;">
                <h2 class="text-center mb-4">Select Your Partnership Package</h2>
                
                <div class="mock-notice" id="mock-notice" style="display: none;">
                    <i class="fas fa-code"></i>
                    <strong>Development Mode:</strong> Using mock data. Packages will sync with admin system when backend is ready.
                </div>
                
                <p class="text-center mb-4">Choose the partnership package that best fits your organization's goals</p>
                
                <div class="package-cards">
                    <!-- Packages will be loaded dynamically from the admin system -->
                </div>
                
                <div class="button-container">
                    <button type="button" class="btn btn-outline-standard" id="back-to-main-form-btn">
                        <i class="fas fa-arrow-circle-left me-2"></i> Back
                    </button>
                    <button type="button" class="btn btn-standard" id="continue-to-payment-btn" disabled>
                        Continue to Payment <i class="fas fa-arrow-circle-right ms-2"></i>
                    </button>
                </div>
            </div>

            <!-- Step 3: Payment Section -->
            <div id="payment-section" class="form-section" style="display: none;">
                <h2 class="text-center mb-4">Payment Information</h2>
                
                <div class="payment-section">
                    <div class="form-group">
                        <label class="has-star">Select Payment Method</label>
                        <div class="payment-option">
                            <input type="radio" id="bank-transfer" name="payment-method" value="bank-transfer">
                            <label for="bank-transfer">Bank Transfer</label>
                        </div>
                        <div class="payment-option">
                            <input type="radio" id="flutterwave" name="payment-method" value="flutterwave">
                            <label for="flutterwave">Paystack</label>
                        </div>
                    </div>
                    
                    <div class="payment-form" id="bank-transfer-form">
                        <h5>Bank Transfer Details</h5>
                        <!-- Add payment amount dynamically here -->
                        <div id="bank-transfer-amount"></div>
                        <p><strong>Bank Name:</strong> First Bank Nigeria</p>
                        <p><strong>Account Name:</strong> ICSC 2026 Conference</p>
                        <p><strong>Account Number:</strong> 1234567890</p>
                        <p><strong>Sort Code:</strong> 123456</p>
                        <p>Please include your registration ID as the payment reference.</p>
                        
                        <!-- Payment Receipt Upload - Only for Bank Transfer -->
                        <div class="form-group mt-4">
                            <label class="has-star" for="paymentReceipt">Upload Payment Receipt</label>
                            <input type="file" id="paymentReceipt" name="paymentReceipt" class="form-control" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx">
                            <div class="help-block-error" id="paymentReceipt-error"></div>
                            <div class="hint-block">Accepted formats: PDF, JPG, PNG, DOC (Max size: 5MB)</div>
                        </div>
                    </div>
                    
                    <div class="payment-form" id="flutterwave-form">
                        <h5>Flutterwave Payment</h5>
                        <div class="mock-notice" style="margin-bottom: 15px;">
                            <i class="fas fa-info-circle"></i>
                            In development mode, this shows a success message instead of redirecting to payment.
                        </div>
                        <p>You will be redirected to Flutterwave's secure payment gateway to complete your transaction.</p>
                        <p>Accepted payment methods:</p>
                        <ul>
                            <li>Visa/Mastercard</li>
                            <li>Bank Transfer</li>
                            <li>USSD</li>
                            <li>Mobile Money</li>
                        </ul>
                        <button type="button" class="btn btn-standard" id="pay-with-flutterwave">
                            <i class="fas fa-credit-card me-2"></i>Pay with Paystack
                        </button>
                    </div>
                </div>
                
                <div class="button-container">
                    <button type="button" class="btn btn-outline-standard" id="back-to-package-btn">
                        <i class="fas fa-arrow-circle-left me-2"></i> Back
                    </button>
                    <button type="button" class="btn btn-standard" id="complete-registration-btn" disabled>
                        Complete Registration
                    </button>
                </div>
            </div>

            <!-- Step 4: Confirmation Section -->
            <div id="confirmation-section" class="form-section" style="display: none;">
                <h2 class="text-center mb-4">Registration Confirmation</h2>
                
                <div class="success-message">
                    <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                    <h3>Registration Successful!</h3>
                    <p class="mb-0">Thank you for registering as a Partner for the International Civil Service Conference 2026.</p>
                </div>
                
                <div class="confirmation-details">
                    <h4 class="mb-3">Registration Details</h4>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Registration ID</div>
                        <div class="confirmation-value" id="confirmation-id">ICSC2026-001234</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Registrant Type</div>
                        <div class="confirmation-value" id="confirmation-type">Partner</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Name</div>
                        <div class="confirmation-value" id="confirmation-name">John Doe</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Email</div>
                        <div class="confirmation-value" id="confirmation-email">john.doe@example.com</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Selected Package</div>
                        <div class="confirmation-value" id="confirmation-package">Basic Partner Package</div>
                    </div>
                    <div class="confirmation-item">
                        <div class="confirmation-label">Payment Status</div>
                        <div class="confirmation-value" id="confirmation-payment">Pending</div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <p>A confirmation email has been sent to <strong id="confirmation-email-text">john.doe@example.com</strong> with all the details.</p>
                    <div class="button-container">
                        <button type="button" class="btn btn-standard" id="go-to-dashboard-btn">
                            Go to Dashboard
                        </button>
                        <a href="Index.html" class="btn btn-outline-standard">Return to Conference Website</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer-container">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>INTERNATIONAL CIVIL SERVICE CONFERENCE (ICSC) 2026</h5>
                    <p>Building Global Civil Service Excellence</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5>Contact Us</h5>
                    <p>Email: info@icsc2026.org</p>
                    <p>Phone: +1 (555) 123-4567</p>
                    <div class="social-media-links mt-3">
                        <a href="#" class="me-3"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="me-3"><i class="fab fa-linkedin fa-lg"></i></a>
                        <a href="#" class="me-3"><i class="fab fa-facebook fa-lg"></i></a>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <p class="mb-0">&copy; 2026 International Civil Service Conference. All rights reserved.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <script src="js/apiClient.js"></script>
    <script src="js/auth.js"></script>
   <script>

           // ============================================
        // MAIN APPLICATION CODE
        // ============================================

        // Global variables for partner registration
        let currentStep = 1;
        const selectedRegistrantType = 'partner';
        let selectedPackage = '';
        let selectedPackageId = null;
        let selectedPaymentMethod = '';
        let phoneInputs = [];
        let uploadedLogoUrl = ''; // holds the uploaded company logo URL returned by /misc/upload-image
        let lastPartnerRegistrationResponse = null;
        let availablePackages = [];
        let autoRefreshInterval = null; // For auto-refresh functionality
        let selectedPackageDashboard = 'partners-dash.html'; // Default dashboard
        
        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        async function initializeApp() {
            try {

                 // Populate country dropdowns
        populateCountryDropdowns();
        
                // Fetch packages from backend and render them
                await fetchAndRenderPackages();

                // Initialize phone inputs
                initializePhoneInputs();

                // Set up event listeners
                setupEventListeners();

                // Setup package selection (after dynamic rendering)
                setupPackageSelection();

                // Setup payment section
                setupPaymentSection();

                // Start auto-refresh for packages (every 10 seconds)
                startAutoRefresh();

            } catch (error) {
                console.error('Error initializing app:', error);
            }
        }

        // Fetch partner packages from backend and render into the .package-cards container
        async function fetchAndRenderPackages() {
            const container = document.querySelector('.package-cards');
            if (!container) return;

            // Clear container
            container.innerHTML = '';

            // HARDCODED PACKAGES
            const hardcodedPackages = [
                {
                    id: 1,
                    name: "Bronze Partner",
                    slug: "bronze-partner",
                    price: 5000000,
                    investment: 5000000,
                    description: "Basic partnership package with standard benefits",
                    features: [
                        "Company logo on website",
                        "Social media mention",
                        "1 conference pass",
                        "Exhibition space (optional)",
                        "Partner certificate",
                        " Company logo included on all delegate and commercial emails, social media posts and world press conference announcing your company as a partner (Basic Coverage)"
                    ],
                    max_count: 20,
                    current_count: 5,
                    redirect_dashboard: "partners-dash.html"
                },
                {
                    id: 2,
                    name: "Silver Partner", 
                    slug: "silver-partner",
                    price: 10000000,
                    investment: 10000000,
                    description: "Enhanced partnership with additional visibility",
                    features: [
                        "All Bronze benefits",
                        "Logo on conference backdrop",
                        "2 conference passes",
                        "Full page in program booklet",
                        "Speaker/panelist/roundtable delegate profile promoted in line with the event agenda",
                        "Company logo included on all delegate and commercial emails, social media posts and world press conference announcing your company as a partner (Full coverage)"
                    ],
                    max_count: 15,
                    current_count: 3,
                    redirect_dashboard: "partners-dash.html"
                },
                {
                    id: 3,
                    name: "Gold Partner",
                    slug: "gold-partner", 
                    price: 15000000,
                    investment: 15000000,
                    description: "Premium partnership with prominent visibility",
                    features: [
                        "All Silver benefits",
                        "Speaking slot (5 mins)",
                        "4 conference passes",
                        "Speaker/panelist/roundtable delegate profile promoted in line with the event agenda",
                        "VIP dinner invitation",
                        "Space located in the main exhibition area for 2 days. Offered as space only",
                        "Company logo included on all delegate and commercial emails, social media posts and world press conference announcing your company as a partner (Full coverage)"
                    ],
                    max_count: 10,
                    current_count: 2,
                    redirect_dashboard: "partners-dash.html"
                },
                {
                    id: 4, 
                    name: "Platinum Partner",
                    slug: "platinum-partner",
                    price: 30000000,
                    investment: 30000000,
                    description: "Exclusive top-tier partnership",
                    features: [
                        "Speaker/panelist/roundtable delegate profile promoted in line with the event agenda",
                        "Keynote speaking slot (15 mins)",
                        "Guest passes: opportunity to invite a limited number of your own VIPs to the event. (Not to be used for Guest passes: opportunity to invite a limited number of your own VIPs to the event.)",
                        "Premium exhibition location",
                        "Space located in the main exhibition area for 2 days. Offered as space only",
                        "Company logo and profile on event website (Full coverage) ",
                        "News coverage of your session published on the OHCSF Website and shared in the Civil Service newsletter"
                    ],
                    max_count: 5,
                    current_count: 1,
                    redirect_dashboard: "partners-dash.html"
                }
            ];

            // Store in global array
            availablePackages = hardcodedPackages;

            // Render each package
            hardcodedPackages.forEach(pkg => {
                const card = document.createElement('div');
                card.className = 'package-card';
                card.setAttribute('data-package', pkg.slug);
                card.setAttribute('data-package-id', String(pkg.id));
                
                const price = pkg.investment || pkg.price || 0;
                const priceText = price.toLocaleString();
                
                // Features HTML
                let featuresHtml = '';
                if (Array.isArray(pkg.features) && pkg.features.length > 0) {
                    featuresHtml = '<ul>' + pkg.features.map(f => `<li>${f}</li>`).join('') + '</ul>';
                } else if (pkg.description) {
                    featuresHtml = `<p class="package-description">${pkg.description}</p>`;
                }
                
                // Availability
                const currentCount = pkg.current_count || 0;
                const maxCount = pkg.max_count || 0;
                const isAvailable = maxCount === 0 || currentCount < maxCount;
                
                let limitedText = '';
                if (!isAvailable) {
                    limitedText = `<div class="limited" style="color: #dc3545;">Fully Booked</div>`;
                    card.classList.add('disabled');
                    card.style.opacity = '0.6';
                    card.style.cursor = 'not-allowed';
                } else if (maxCount > 0) {
                    const remaining = maxCount - currentCount;
                    limitedText = `<div class="limited">${remaining} of ${maxCount} slots remaining</div>`;
                } else {
                    limitedText = `<div class="limited">Unlimited slots available</div>`;
                }
                
                // Card HTML - THIS IS WHERE THE PRICE IS DISPLAYED
                card.innerHTML = `
                    <h4>${pkg.name}</h4>
                    <div class="price">â‚¦${priceText}</div>
                    ${featuresHtml}
                    ${limitedText}
                `;
                
                container.appendChild(card);
            });
            
            // Add refresh status indicator
            updateRefreshStatus();
        }
        
        // Start auto-refresh for packages
        function startAutoRefresh() {
            // Clear any existing interval
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
            
            // Set up new interval (10 seconds = 10000 milliseconds)
            autoRefreshInterval = setInterval(async () => {
                try {
                    // Only refresh if we're on the package selection step
                    if (currentStep === 2) {
                        await silentPackageRefresh();
                    }
                } catch (error) {
                    console.error('Auto-refresh failed:', error);
                }
            }, 10000); // 10 seconds
            
            console.log('Auto-refresh started: Packages will refresh every 10 seconds');
        }
        
        // Silent package refresh (no UI notifications)
        async function silentPackageRefresh() {
            try {
                const oldPackages = [...availablePackages];
                await fetchAndRenderPackages();
                
                // Check if selected package is still available
                if (selectedPackageId) {
                    const isAvailable = await checkPackageAvailability(selectedPackageId);
                    if (!isAvailable) {
                        // Package no longer available, reset selection
                        selectedPackage = '';
                        selectedPackageId = null;
                        selectedPackageDashboard = 'partners-dash.html';
                        document.querySelectorAll('.package-card').forEach(c => c.classList.remove('selected'));
                        const continueBtn = document.getElementById('continue-to-payment-btn');
                        if (continueBtn) continueBtn.disabled = true;
                        
                        // Show subtle notification
                        showNotification('Your selected package is no longer available. Please select a different package.', 'warning', 3000);
                    }
                }
                
                // Reattach event listeners
                setupPackageSelection();
                
            } catch (err) {
                console.error('Silent refresh failed:', err);
            }
        }
        
        // Update refresh status indicator
        function updateRefreshStatus() {
            let statusElement = document.getElementById('refresh-status');
            if (!statusElement) {
                const packageSection = document.querySelector('#package-section');
                if (packageSection) {
                    statusElement = document.createElement('div');
                    statusElement.id = 'refresh-status';
                    statusElement.className = 'text-center mt-3';
                    statusElement.style.cssText = `
                        font-size: 0.85rem;
                        color: #6c757d;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                    `;
                    
                    const icon = document.createElement('i');
                    icon.className = 'fas fa-sync-alt fa-spin';
                    icon.style.fontSize = '0.8rem';
                    
                    const text = document.createElement('span');
                    text.id = 'refresh-status-text';
                    text.textContent = 'Auto-refreshing packages...';
                    
                    statusElement.appendChild(icon);
                    statusElement.appendChild(text);
                    
                    const packageCards = document.querySelector('.package-cards');
                    if (packageCards && packageCards.parentNode) {
                        packageCards.parentNode.insertBefore(statusElement, packageCards.nextSibling);
                    }
                }
            }
            
            if (statusElement) {
                const textElement = statusElement.querySelector('#refresh-status-text');
                if (textElement) {
                    const now = new Date();
                    const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'});
                    textElement.textContent = `Packages auto-refresh every 10s | Last updated: ${timeString}`;
                }
            }
        }
        
        // Manual refresh packages function
        async function refreshPackages() {
            const refreshBtn = document.getElementById('refresh-packages-btn');
            if (refreshBtn) {
                const originalText = refreshBtn.innerHTML;
                refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
                refreshBtn.disabled = true;
                
                try {
                    await fetchAndRenderPackages();
                    
                    // Reset selection if the selected package is no longer available
                    if (selectedPackageId) {
                        const isAvailable = await checkPackageAvailability(selectedPackageId);
                        if (!isAvailable) {
                            selectedPackage = '';
                            selectedPackageId = null;
                            selectedPackageDashboard = 'partners-dash.html';
                            document.querySelectorAll('.package-card').forEach(c => c.classList.remove('selected'));
                            const continueBtn = document.getElementById('continue-to-payment-btn');
                            if (continueBtn) continueBtn.disabled = true;
                            
                            showNotification('Your selected package is no longer available. Please select a different package.', 'warning');
                        }
                    }
                    
                    // Reattach event listeners
                    setupPackageSelection();
                    
                    showNotification('Packages refreshed successfully!', 'success');
                } catch (err) {
                    console.error('Failed to refresh packages:', err);
                    showNotification('Failed to refresh packages. Please try again.', 'error');
                } finally {
                    refreshBtn.innerHTML = originalText;
                    refreshBtn.disabled = false;
                }
            }
        }
        
        // Check package availability function - FIXED VERSION
        async function checkPackageAvailability(packageId) {
            try {
                const resp = await window.apiClient.get(`/packages/check-availability/${packageId}`);
                const respData = resp && (resp.data || resp);
                return respData && respData.available !== false;
            } catch (err) {
                // If endpoint doesn't exist (404), fall back to local calculation
                if (err.status === 404 || err.response?.status === 404) {
                    console.log('Availability endpoint not found, using local calculation');
                    return checkLocalPackageAvailability(packageId);
                }
                console.error('Error checking package availability:', err);
                return true; // Default to available on error
            }
        }
        
        // Local package availability check (fallback when endpoint doesn't exist)
        function checkLocalPackageAvailability(packageId) {
            const pkg = availablePackages.find(p => p.id === packageId);
            if (!pkg) return false;
            
            const currentCount = pkg.current_count || pkg.currentRegistrants || 0;
            const maxCount = pkg.max_count || pkg.maxRegistrants || 0;
            const isForcedClosed = pkg.force_closed || false;
            
            return !isForcedClosed && (maxCount === 0 || currentCount < maxCount);
        }
        
        function initializePhoneInputs() {
            const phoneInputIds = ['workPhone'];
            
            phoneInputs = phoneInputs || [];
            
            phoneInputIds.forEach(id => {
                const input = document.getElementById(id);
                if (input && window.intlTelInput) {
                    try {
                        const iti = window.intlTelInput(input, {
                            initialCountry: "ng",
                            separateDialCode: true,
                            utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
                        });
                        phoneInputs.push({ id, iti });
                    } catch (error) {
                        console.error(`Error initializing phone input ${id}:`, error);
                    }
                }
            });
        }
        
        function setupEventListeners() {
            // Password toggle functionality
            const togglePassword = document.getElementById('togglePassword');
            const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            
            if (togglePassword && passwordInput) {
                togglePassword.addEventListener('click', function() {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            }
            
            if (toggleConfirmPassword && confirmPasswordInput) {
                toggleConfirmPassword.addEventListener('click', function() {
                    const type = confirmPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    confirmPasswordInput.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            }
            
            // Navigation buttons
            const continueToPackageBtn = document.getElementById('continue-to-package-btn');
            if (continueToPackageBtn) {
                continueToPackageBtn.addEventListener('click', function() {
                    if (validateMainForm()) {
                        showStep(2);
                    }
                });
            }
            
            const backToMainFormBtn = document.getElementById('back-to-main-form-btn');
            if (backToMainFormBtn) {
                backToMainFormBtn.addEventListener('click', function() {
                    showStep(1);
                });
            }
            
            const continueToPaymentBtn = document.getElementById('continue-to-payment-btn');
            if (continueToPaymentBtn) {
                continueToPaymentBtn.addEventListener('click', async function() {
                    if (!selectedPackageId) {
                        alert('Please select a package first');
                        return;
                    }

                    // Proceed with validation
                    if (!validatePackageSelection()) return;

                    // Attempt to create event partner on continue
                    try {
                        this.disabled = true;
                        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
                        await registerEventPartnerOnPackageSelect();

                        // proceed to payment step on success
                        showStep(3);
                    } catch (err) {
                        console.error('Failed to register event partner before payment:', err);
                        // MODIFICATION: Continue to payment even in mock mode
                        showStep(3);
                    } finally {
                        this.disabled = false;
                        this.innerHTML = 'Continue to Payment <i class="fas fa-arrow-circle-right ms-2"></i>';
                    }
                });
            }
            
            const backToPackageBtn = document.getElementById('back-to-package-btn');
            if (backToPackageBtn) {
                backToPackageBtn.addEventListener('click', function() {
                    showStep(2);
                });
            }
            
            const completeRegistrationBtn = document.getElementById('complete-registration-btn');
            if (completeRegistrationBtn) {
                completeRegistrationBtn.addEventListener('click', async function() {
                    if (validatePaymentForm()) {
                        await processRegistration();
                    }
                });
            }
            
            // Flutterwave payment button
            const flutterwaveBtn = document.getElementById('pay-with-flutterwave');
            if (flutterwaveBtn) {
                flutterwaveBtn.addEventListener('click', function() {
                    processFlutterwavePayment();
                });
            }
            
            // Dashboard button - Updated to use dynamic dashboard URL
            const goToDashboardBtn = document.getElementById('go-to-dashboard-btn');
            if (goToDashboardBtn) {
                goToDashboardBtn.addEventListener('click', function() {
                    redirectToDashboard();
                });
            }
        }
        
        function setupPackageSelection() {
            const packageCards = document.querySelectorAll('.package-card:not(.disabled)');
            packageCards.forEach(card => {
                card.addEventListener('click', function() {
                    // Skip disabled packages
                    if (this.classList.contains('disabled')) {
                        showNotification('This package is not available for selection', 'warning');
                        return;
                    }
                    
                    // Remove selected class from all cards
                    document.querySelectorAll('.package-card').forEach(c => c.classList.remove('selected'));
                    
                    // Add selected class to clicked card
                    this.classList.add('selected');
                    
                    // Store selected package (slug) and id
                    selectedPackage = this.getAttribute('data-package');
                    const pkgIdAttr = this.getAttribute('data-package-id');
                    selectedPackageId = pkgIdAttr ? Number(pkgIdAttr) : null;
                    
                    // Get package details - FIXED: Use the package from availablePackages array
                    const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                    if (selectedPkg) {
                        console.log('Selected package:', selectedPkg.name || selectedPkg.title, 'Price:', selectedPkg.price);
                        
                        // Store the dashboard URL for this package
                        selectedPackageDashboard = selectedPkg.redirect_dashboard || selectedPkg.dashboard_url || 'partners-dash.html';
                        
                        // Check if this is an exhibitor package
                        if (selectedPkg.is_exhibitor) {
                            console.log('This is an exhibitor package. Will redirect partners dashboard.');
                        }
                    } else {
                        console.warn('Selected package not found in availablePackages array');
                        selectedPackageDashboard = 'partners-dash.html';
                    }
                    
                    // Enable continue button
                    const continueBtn = document.getElementById('continue-to-payment-btn');
                    if (continueBtn) {
                        continueBtn.disabled = false;
                    }
                    
                    showNotification(`Selected: ${selectedPackage} package`, 'success');
                });
            });
        }
        // Country list for dropdowns 
const countries = [
    "Nigeria", "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia", 
    "Australia", "Austria", "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", 
    "Belize", "Benin", "Bhutan", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria", 
    "Burkina Faso", "Burundi", "Cabo Verde", "Cambodia", "Cameroon", "Canada", "Central African Republic", "Chad", 
    "Chile", "China", "Colombia", "Comoros", "Congo", "Costa Rica", "Croatia", "Cuba", "Cyprus", "Czech Republic", 
    "Denmark", "Djibouti", "Dominica", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea", 
    "Eritrea", "Estonia", "Eswatini", "Ethiopia", "Fiji", "Finland", "France", "Gabon", "Gambia", "Georgia", 
    "Germany", "Ghana", "Greece", "Grenada", "Guatemala", "Guinea", "Guinea-Bissau", "Guyana", "Haiti", "Honduras", 
    "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Israel", "Italy", "Jamaica", "Japan", 
    "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Korea, North", "Korea, South", "Kosovo", "Kuwait", "Kyrgyzstan", 
    "Laos", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libya", "Liechtenstein", "Lithuania", "Luxembourg", "Madagascar", 
    "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Mauritania", "Mauritius", "Mexico", 
    "Micronesia", "Moldova", "Monaco", "Mongolia", "Montenegro", "Morocco", "Mozambique", "Myanmar", "Namibia", 
    "Nauru", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", "North Macedonia", "Norway", 
    "Oman", "Pakistan", "Palau", "Palestine", "Panama", "Papua New Guinea", "Paraguay", "Peru", "Philippines", 
    "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saint Kitts and Nevis", "Saint Lucia", 
    "Saint Vincent and the Grenadines", "Samoa", "San Marino", "Sao Tome and Principe", "Saudi Arabia", "Senegal", 
    "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "Solomon Islands", "Somalia", 
    "South Africa", "South Sudan", "Spain", "Sri Lanka", "Sudan", "Suriname", "Sweden", "Switzerland", "Syria", 
    "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Timor-Leste", "Togo", "Tonga", "Trinidad and Tobago", "Tunisia", 
    "Turkey", "Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", 
    "Uruguay", "Uzbekistan", "Vanuatu", "Vatican City", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"
];

function populateCountryDropdowns() {
    const countrySelectors = ['country'];
    
    countrySelectors.forEach(selector => {
        const select = document.getElementById(selector);
        if (select) {
            const placeholder = select.options.length ? select.options[0].outerHTML : '<option value="" disabled>Select your country</option>';
            select.innerHTML = placeholder;
            
            countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                select.appendChild(option);
            });
            
            Array.from(select.options).forEach(opt => {
                if (!opt.value || opt.value.trim() === '') {
                    opt.value = opt.textContent.trim();
                }
            });
            
            // Set empty default
            select.selectedIndex = 0;
        }
    });
}

        async function registerEventPartnerOnPackageSelect() {
            try {
                // MODIFICATION: Mock the API response for demo mode
                console.log('Mock: Creating partner registration record');
                
                // Create a mock response
                lastPartnerRegistrationResponse = {
                    success: true,
                    data: {
                        id: Date.now(),
                        reference: 'ICSC2026-MOCK-' + Math.floor(Math.random() * 10000),
                        token: 'mock-jwt-token-' + Date.now()
                    }
                };
                
                // Store mock token for dashboard access
                localStorage.setItem('authUser', JSON.stringify({ 
                    token: 'mock-jwt-token-' + Date.now() 
                }));
                
                // Show success feedback
                showNotification('Partner registration submitted successfully! (Demo Mode)', 'success');
                
                return lastPartnerRegistrationResponse;
            } catch (err) {
                console.error('Mock registration error:', err);
                // MODIFICATION: Still return mock data even on "error" for demo
                return {
                    success: true,
                    data: { id: Date.now(), reference: 'ICSC2026-DEMO' }
                };
            }
        }
        
        function setupPaymentSection() {
            const paymentOptions = document.querySelectorAll('.payment-option input');
            paymentOptions.forEach(option => {
                option.addEventListener('change', function() {
                    if (this.checked) {
                        selectedPaymentMethod = this.value;
                        // Show/hide payment forms based on selection
                        const paymentForms = document.querySelectorAll('.payment-form');
                        paymentForms.forEach(form => form.style.display = 'none');
                        
                        if (this.value === 'bank-transfer') {
                            const bankForm = document.getElementById('bank-transfer-form');
                            if (bankForm) bankForm.style.display = 'block';
                            
                            // Show payment amount in bank transfer form
                            const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                            if (selectedPkg && bankForm) {
                                const amountElement = bankForm.querySelector('.payment-amount');
                                if (!amountElement) {
                                    const amountInfo = document.createElement('div');
                                    amountInfo.className = 'payment-amount';
                                    amountInfo.innerHTML = `<strong>Amount to Pay:</strong> â‚¦${(selectedPkg.investment || selectedPkg.price || 0).toLocaleString()}`;
                                    bankForm.insertBefore(amountInfo, bankForm.firstChild);
                                }
                            }
                        } else if (this.value === 'flutterwave') {
                            const flutterwaveForm = document.getElementById('flutterwave-form');
                            if (flutterwaveForm) flutterwaveForm.style.display = 'block';
                        }
                        
                        // Enable complete registration button
                        const completeBtn = document.getElementById('complete-registration-btn');
                        if (completeBtn) {
                            completeBtn.disabled = false;
                        }
                        
                        showNotification(`Selected payment method: ${this.value}`, 'success');
                    }
                });
            });
        }
        
        function validateMainForm() {
            let isValid = true;
            
            // Email validation
            const email = document.getElementById('email').value;
            if (!email || !isValidEmail(email)) {
                showError('email-error', 'Please enter a valid email address');
                isValid = false;
            } else {
                hideError('email-error');
            }
            
            // Password validation
            const password = document.getElementById('password').value;
            if (!password || password.length < 8) {
                showError('password-error', 'Password must be at least 8 characters long');
                isValid = false;
            } else {
                hideError('password-error');
            }
            
            // Confirm password validation
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (!confirmPassword || password !== confirmPassword) {
                showError('confirmPassword-error', 'Passwords do not match');
                isValid = false;
            } else {
                hideError('confirmPassword-error');
            }
            
            // Required fields validation
            const requiredFields = [
                'prefix', 'firstName', 'lastName', 'country', 
                'jobTitle', 'organisation', 'workPhone'
            ];
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (!element || !element.value.trim()) {
                    showError(`${field}-error`, 'This field is required');
                    isValid = false;
                } else {
                    hideError(`${field}-error`);
                }
            });
            
            // Data sharing agreement validation
            const dataSharing = document.querySelector('input[name="dataSharing"]:checked');
            if (!dataSharing) {
                showNotification('Please select an option for data sharing agreement', 'warning');
                isValid = false;
            }
            
            // Terms and conditions validation
            const terms = document.getElementById('terms');
            if (!terms || !terms.checked) {
                showNotification('You must agree to the terms and conditions', 'warning');
                isValid = false;
            }
            
            return isValid;
        }
        
        function validatePackageSelection() {
            if (!selectedPackage) {
                showNotification('Please select a partnership package', 'warning');
                return false;
            }
            return true;
        }
        
        function validatePaymentForm() {
            if (!selectedPaymentMethod) {
                showNotification('Please select a payment method', 'warning');
                return false;
            }
            
            // Validate bank transfer receipt upload - ONLY for bank transfers
            if (selectedPaymentMethod === 'bank-transfer') {
                const paymentReceipt = document.getElementById('paymentReceipt');
                if (!paymentReceipt || !paymentReceipt.files || paymentReceipt.files.length === 0) {
                    showError('paymentReceipt-error', 'Please upload your payment receipt');
                    return false;
                }
                
                // Validate file size (5MB max)
                const file = paymentReceipt.files[0];
                const maxSize = 5 * 1024 * 1024; // 5MB in bytes
                if (file.size > maxSize) {
                    showError('paymentReceipt-error', 'File size must be less than 5MB');
                    return false;
                }
                
                // Validate file type
                const allowedTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
                if (!allowedTypes.includes(file.type)) {
                    showError('paymentReceipt-error', 'Please upload a valid file type (PDF, JPG, PNG, DOC)');
                    return false;
                }
                
                hideError('paymentReceipt-error');
            }
            
            return true;
        }
        
        async function processFlutterwavePayment() {
            try {
                // MODIFICATION: Mock payment for demo mode
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                if (selectedPkg) {
                    const amount = Number(selectedPkg.investment || selectedPkg.price || 0);
                    const packageName = selectedPkg.name || selectedPackage;
                    
                    showNotification(`Demo: Payment of â‚¦${amount.toLocaleString()} for ${packageName} would be processed.`, 'info');
                    
                    // For demo purposes, simulate successful payment
                    setTimeout(() => {
                        showNotification('Demo: Payment successful!', 'success');
                        // Enable the complete registration button
                        const completeBtn = document.getElementById('complete-registration-btn');
                        if (completeBtn) {
                            completeBtn.disabled = false;
                        }
                    }, 1500);
                }
                
            } catch (err) {
                console.error('Mock payment error:', err);
                showNotification('Demo payment simulation', 'info');
            }
        }
        
        async function processRegistration() {
            const completeBtn = document.getElementById('complete-registration-btn');
            
            if (completeBtn) {
                completeBtn.classList.add('btn-loading');
                completeBtn.disabled = true;
            }
            
            try {
                // MODIFICATION: Skip actual API calls for demo
                console.log('Demo: Completing registration without API calls');
                
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Update confirmation with mock data
                updateConfirmationSection();
                
                // Add mock confirmation ID if not set
                const confirmationIdEl = document.getElementById('confirmation-id');
                if (confirmationIdEl && !confirmationIdEl.textContent.includes('ICSC')) {
                    confirmationIdEl.textContent = 'ICSC2026-DEMO-' + Math.floor(Math.random() * 10000);
                }
                
                // Show success
                showNotification('Registration completed successfully! (Demo Mode)', 'success');
                
                // Move to confirmation step
                showStep(4);
                
                // ====================================================
                // ADD REDIRECTION LOGIC HERE (NEW CODE)
                // ====================================================
                
                // Determine which dashboard to redirect to based on selected package
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                let redirectUrl = 'partners-dash.html'; // Default
                
                if (selectedPkg) {
                    // Use the redirect_dashboard from package data
                    redirectUrl = selectedPkg.redirect_dashboard || 'partners-dash.html';
                }
                
                // Auto-redirect after 3 seconds (adjust timing as needed)
                setTimeout(() => {
                    window.location.href = redirectUrl;
                }, 3000);
                        
            } catch (err) {
                console.error('Demo registration failed', err);
                showNotification('Registration completed in demo mode', 'info');
                showStep(4); // Still show confirmation
            } finally {
                if (completeBtn) {
                    completeBtn.classList.remove('btn-loading');
                    completeBtn.disabled = false;
                }
            }
        }
        
        function updateConfirmationSection() {
            const email = document.getElementById('email')?.value || '';
            const firstName = document.getElementById('firstName')?.value || '';
            const lastName = document.getElementById('lastName')?.value || '';
            const organisation = document.getElementById('organisation')?.value || '';
            
            const confirmationEmail = document.getElementById('confirmation-email');
            const confirmationEmailText = document.getElementById('confirmation-email-text');
            const confirmationName = document.getElementById('confirmation-name');
            const confirmationType = document.getElementById('confirmation-type');
            const confirmationPackage = document.getElementById('confirmation-package');
            const confirmationPayment = document.getElementById('confirmation-payment');
            
            if (confirmationEmail) confirmationEmail.textContent = email;
            if (confirmationEmailText) confirmationEmailText.textContent = email;
            if (confirmationName) confirmationName.textContent = `${firstName} ${lastName}`.trim() || organisation;
            if (confirmationType) confirmationType.textContent = 'Partner';
            
            // Update package information
            if (confirmationPackage) {
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                if (selectedPkg) {
                    confirmationPackage.textContent = `${selectedPkg.name || selectedPkg.title || selectedPackage} - â‚¦${(selectedPkg.investment || selectedPkg.price || 0).toLocaleString()}`;
                } else {
                    const packageNames = {
                        'bronze-partner': 'Bronze Partner',
                        'silver-partner': 'Silver Partner', 
                        'gold-partner': 'Gold Partner',
                        'platinum-partner': 'Platinum Partner'
                    };
                    confirmationPackage.textContent = packageNames[selectedPackage] || selectedPackage;
                }
            }
            
            // Update payment method
            if (confirmationPayment) {
                const paymentMethods = {
                    'bank-transfer': 'Bank Transfer (Receipt Submitted)',
                    'flutterwave': 'Flutterwave (Online Payment)'
                };
                confirmationPayment.textContent = paymentMethods[selectedPaymentMethod] || selectedPaymentMethod;
            }
            
            // Update dashboard button text based on selected package
            const goToDashboardBtn = document.getElementById('go-to-dashboard-btn');
            if (goToDashboardBtn) {
                const selectedPkg = availablePackages.find(p => p.id === selectedPackageId);
                if (selectedPkg && (selectedPkg.is_exhibitor || selectedPackage === 'bronze-partner')) {
                    goToDashboardBtn.innerHTML = '<i class="fas fa-external-link-alt me-2"></i>Go to Exhibitor Dashboard';
                } else {
                    goToDashboardBtn.innerHTML = '<i class="fas fa-external-link-alt me-2"></i>Go to Partner Dashboard';
                }
            }
        }
        
        function redirectToDashboard() {
            // Show notification about mock mode
            showNotification(`In mock mode, would redirect to: ${selectedPackageDashboard}`, 'info');
            
            // In real implementation:
            // window.location.href = selectedPackageDashboard;
        }
        
        function showStep(step) {
            const sections = ['main-form-section', 'package-section', 'payment-section', 'confirmation-section'];
            
            sections.forEach(section => {
                const element = document.getElementById(section);
                if (element) {
                    element.style.display = 'none';
                }
            });
            
            let currentSection;
            if (step === 1) {
                currentSection = document.getElementById('main-form-section');
            } else if (step === 2) {
                currentSection = document.getElementById('package-section');
            } else if (step === 3) {
                currentSection = document.getElementById('payment-section');
            } else if (step === 4) {
                currentSection = document.getElementById('confirmation-section');
                
                // Show mock notice in confirmation if in mock mode
                if (typeof window.apiClient !== 'undefined' && window.apiClient.mockPackages) {
                    const mockNotice = document.getElementById('confirmation-mock-notice');
                    if (mockNotice) {
                        mockNotice.style.display = 'block';
                    }
                }
            }
            
            if (currentSection) {
                currentSection.style.display = 'block';
            }
            
            // Update current step
            currentStep = step;
            
            // Start or stop auto-refresh based on current step
            if (step === 2) {
                // On package selection step, ensure auto-refresh is running
                if (!autoRefreshInterval) {
                    startAutoRefresh();
                }
            } else {
                // On other steps, stop auto-refresh to save resources
                if (autoRefreshInterval) {
                    clearInterval(autoRefreshInterval);
                    autoRefreshInterval = null;
                    console.log('Auto-refresh paused (not on package selection step)');
                }
            }
            
            window.scrollTo(0, 0);
        }

        // Helper function to show notifications
        function showNotification(message, type = 'success', duration = 5000) {
            // Create notification element if it doesn't exist
            let notificationEl = document.getElementById('registration-notification');
            if (!notificationEl) {
                notificationEl = document.createElement('div');
                notificationEl.id = 'registration-notification';
                notificationEl.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 500;
                    z-index: 9999;
                    display: none;
                    max-width: 300px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                `;
                document.body.appendChild(notificationEl);
            }
            
            // Set notification style based on type
            const colors = {
                success: '#28a745',
                error: '#dc3545',
                warning: '#ffc107',
                info: '#17a2b8'
            };
            
            notificationEl.style.backgroundColor = colors[type] || colors.success;
            notificationEl.textContent = message;
            notificationEl.style.display = 'block';
            
            // Auto-hide after duration
            setTimeout(() => {
                notificationEl.style.display = 'none';
            }, duration);
        }
        
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        function showError(errorId, message) {
            const errorElement = document.getElementById(errorId);
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.style.display = 'block';
                
                const inputId = errorId.replace('-error', '');
                const inputElement = document.getElementById(inputId);
                if (inputElement) {
                    inputElement.classList.add('error');
                }
            }
        }
        
        function hideError(errorId) {
            const errorElement = document.getElementById(errorId);
            if (errorElement) {
                errorElement.style.display = 'none';
                
                const inputId = errorId.replace('-error', '');
                const inputElement = document.getElementById(inputId);
                if (inputElement) {
                    inputElement.classList.remove('error');
                }
            }
        }
    </script>
</body>
</html>